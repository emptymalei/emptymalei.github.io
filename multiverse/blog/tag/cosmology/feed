<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>时见疏星 &#187; 宇宙学</title>
	<atom:link href="http://multiverse.lamost.org/blog/tag/cosmology/feed" rel="self" type="application/rss+xml" />
	<link>http://multiverse.lamost.org/blog</link>
	<description>流年暗中偷换</description>
	<lastBuildDate>Tue, 28 Apr 2015 15:55:56 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.2.2</generator>
	<item>
		<title>关于宇宙膨胀的两个常见误解</title>
		<link>http://multiverse.lamost.org/blog/6041</link>
		<comments>http://multiverse.lamost.org/blog/6041#comments</comments>
		<pubDate>Thu, 05 Sep 2013 15:23:11 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[宇宙膨胀]]></category>
		<category><![CDATA[物理]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=6041</guid>
		<description><![CDATA[超过光速的膨胀 狭义相对论告诉我们，信息传播不能超过光速，否则会有违反因果律的问题。那么，我们说宇宙在膨胀，宇宙膨胀会超过光速么？ 超越光速 为了看清楚这个问题，我们需要拿出我们的数学工具。假定存在一组随着宇宙一起膨胀的惯性观者，该组观者在观察宇宙中的两个点：${t, r_1,\theta,\phi }$, ${t, r_2,\theta,\phi}$. 这里为了简便，使用了（广义）球坐标。而且，这里使用的是 comoving coordinate，或者叫做共形距离，空间部分并不会变化。 我们通过狭义相对论已经知道了，两点之间的距离的计算方法。实际上在我们常常说的 FRW 宇宙，也就是各项同性且均匀的宇宙中，距离的计算方法是 $$ \mathrm ds^2 = c^2 dt^2 + a(t)^2( \mathrm dr^2 + \chi ( \mathrm d\theta^2 \sin^2\theta \mathrm d\phi^2 ) ) ,$$ 其中 $a(t)$ 是 scale factor，代表了宇宙的尺度的变化，可以说是宇宙中尺子的共形变换因子。...<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/2782" rel="bookmark" title="修改引力理论[脑图]">修改引力理论[脑图] </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2410" rel="bookmark" title="宇宙学笔记本存档">宇宙学笔记本存档 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2292" rel="bookmark" title="Relativistic Thermal Dynamics | 相对论性热力学">Relativistic Thermal Dynamics | 相对论性热力学 </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[
<h2>超过光速的膨胀</h2>
<p>狭义相对论告诉我们，信息传播不能超过光速，否则会有违反因果律的问题。那么，我们说宇宙在膨胀，宇宙膨胀会超过光速么？<span id="more-6041"></span></p>
<h3>超越光速</h3>
<p>为了看清楚这个问题，我们需要拿出我们的数学工具。假定存在一组随着宇宙一起膨胀的惯性观者，该组观者在观察宇宙中的两个点：${t, r_1,\theta,\phi }$, ${t, r_2,\theta,\phi}$. 这里为了简便，使用了（广义）球坐标。而且，这里使用的是 comoving coordinate，或者叫做共形距离，空间部分并不会变化。</p>
<p>我们通过狭义相对论已经知道了，两点之间的距离的计算方法。实际上在我们常常说的 FRW 宇宙，也就是各项同性且均匀的宇宙中，距离的计算方法是</p>
<p>$$ \mathrm ds^2 = c^2 dt^2 + a(t)^2( \mathrm dr^2 + \chi ( \mathrm d\theta^2 \sin^2\theta \mathrm d\phi^2 ) ) ,$$</p>
<p>其中 $a(t)$ 是 scale factor，代表了宇宙的尺度的变化，可以说是宇宙中尺子的共形变换因子。</p>
<p>把我们定义的两点的坐标代入进去，会得到</p>
<p>$$ s = a(t) (r_1 &#8211; r_2) .$$</p>
<p>我们想要看的是 s 的变化的快慢，也就是「速度」，</p>
<p>$$ \frac{\mathrm ds}{\mathrm dt} = \dot a (r_1 &#8211; r_2) .$$</p>
<p>也就是说，只要宇宙膨胀的速度足够快（$\dot a$ 足够大），不管这里两点之间的共形距离多么小，<strong>这个所谓的速度总可能超过光速</strong>。</p>
<h3>所谓速度</h3>
<p>我们来看看这个速度是什么意思。</p>
<p>我们讨论的是一个两个点相互背离的速度，这种算法跟我们在狭义相对论里面的一个常见的计算一样。即，如果有两个飞船分别从南极和北极飞出，各以 0.75c 的速度背离地球。那么我们作为地球上的观察者，这两个飞船相互背离的速度，就只能这样加起来，也就是 1.5c .</p>
<p>怎么？这个会违背相对论？不会。因为这压根不是任何形式的信息传递速度。</p>
<p>我们这里计算的所谓的超越光速的膨胀，跟这个例子是一样的，压根就不是真正的物理速度，没有信号传递。</p>
<h2>什么在膨胀？什么不膨胀？</h2>
<p>一起这个问题在豆瓣物理组讨论过。我再拿出来说说。</p>
<p>这个问题是说，如果我们说宇宙在膨胀，现在我们要量两个星系之间的距离，如果尺子也随着宇宙进行相同的膨胀，那么我们用这把尺子量，是不能发现宇宙的膨胀的。当然这只是个很简单的情形，这个问题带来的一个思考是：我们说宇宙膨胀，到底是什么膨胀？尺子会膨胀么？</p>
<h3>我们的太阳系会膨胀么</h3>
<p>我们现在考虑，我们的太阳系现在在膨胀么？</p>
<p>显然我们的太阳系（几乎）没有膨胀。</p>
<p>那我们的银河系在膨胀么？</p>
<p>也（几乎）没有。</p>
<p>那么一个半径 10000 Mpc 的区域呢？</p>
<p>这个是在膨胀的。</p>
<p>那么，我们是怎么判断的呢？</p>
<h3>简单的判据</h3>
<p>我们还是需要使用数学来做一个简单的推算。</p>
<p>考虑一个直径为 $D$ 的区域，假定这个区域内的物质分布是均匀的。</p>
<p>我们知道宇宙的膨胀是通过 $a$ 来体现的，更加确切的说，是通过 $H(a)$ 这个哈勃参数来体现的。实际上 $H(t)$ （常使用 km/s/Mpc 的单位）的意思是值得在每个 MPc 的距离上，星系的推行速度。也就是说，$c H^{-1}$ 就代指了有因果联系的区域的大致的直径大小。</p>
<p>所以我们的判据应该是：</p>
<ul>
<li>如果 $D\gt c H^{-1}$，那么这个区域就是在膨胀的，因为任何形式的束缚场都不能够在大于 $cH^{-1}$ 的区域上进行作用；</li>
<li>如果 $D\lt c H^{-1}$，那么这个区域是基本不膨胀的，因为这些物体可以被引力（或其他作用）束缚住。</li>
</ul>
<p>总之，膨胀还是不膨胀，考虑的是宇宙膨胀的效应和物体之间的束缚场的作用谁强谁弱。</p>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/2782" rel="bookmark" title="修改引力理论[脑图]">修改引力理论[脑图] </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2410" rel="bookmark" title="宇宙学笔记本存档">宇宙学笔记本存档 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2292" rel="bookmark" title="Relativistic Thermal Dynamics | 相对论性热力学">Relativistic Thermal Dynamics | 相对论性热力学 </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/6041/feed</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>宇宙学中的统计方法【丁】</title>
		<link>http://multiverse.lamost.org/blog/4389</link>
		<comments>http://multiverse.lamost.org/blog/4389#comments</comments>
		<pubDate>Thu, 06 Dec 2012 21:05:03 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[Statistics]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[物理]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=4389</guid>
		<description><![CDATA[宇宙学中的统计方法笔记系列，第四篇：likelihood 函数的计算方法，包括如何剔除没用的模式和如何找到 likelihood 的极值。 系列文章目录： 宇宙学中的统计方法【甲】 宇宙学中的统计方法【乙】 宇宙学中的统计方法【丙】 宇宙学中的统计方法【丁】 在 likelihood 方程里面是需要求解矩阵的逆（可参考CMB 的 likelihood 方程），而实际观测中数据量又极大，所有直接求逆会实际计算很慢，因此一种有效的求解 likelihood function 的方法是很重要的。 Modern Cosmology 里面举了一个具体的例子。 Karhunen-Loeve Techniques 这种方法的主要想法是，丢掉那么严重被噪声污染的模。比如我们发现有用的模只有10%，那么计算逆矩阵的话，计算量就减少到了原来的1/1000。但是如何找出那些有用的模呢？ 如果 covariance matrix 是对角的，我们之前在 【乙】 部分中提到对于对角化的 covariance matrix，我们可以得到 &#92;(C_S/C_N&#92;)，也就是信噪比。通过看信噪比的强弱，就可以知道那些模是有用的。可是真正的观测中，得到的数据的 covariance matrix 并不是对角化的，得到信噪比就比较困难。这正是 Karhunen-Loeve 方法所解决的问题。 现在假定我们有 &#92;(N_p&#92;)...<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/4364" rel="bookmark" title="宇宙学中的统计方法【丙】">宇宙学中的统计方法【丙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2970" rel="bookmark" title="宇宙学中的统计方法【乙】">宇宙学中的统计方法【乙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2918" rel="bookmark" title="宇宙学中的统计方法【甲】">宇宙学中的统计方法【甲】 </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[<p>宇宙学中的统计方法笔记系列，第四篇：likelihood 函数的计算方法，包括如何剔除没用的模式和如何找到 likelihood 的极值。<span id="more-4389"></span></p>

<p>系列文章目录：</p>
<ul>
<li><a href="http://multiverse.lamost.org/blog/2918">宇宙学中的统计方法【甲】</a></li>
<li><a href="http://multiverse.lamost.org/blog/2970">宇宙学中的统计方法【乙】</a></li>
<li><a href="http://multiverse.lamost.org/blog/4364">宇宙学中的统计方法【丙】</a></li>
<li><a href="http://multiverse.lamost.org/blog/4389">宇宙学中的统计方法【丁】</a></li>
</ul>
<hr />
<p>在 likelihood 方程里面是需要求解矩阵的逆（可参考<a href="http://multiverse.lamost.org/blog/2970#mjx-eqn-eqn-multipixellikelihood" target="_blank">CMB 的 likelihood 方程</a>），而实际观测中数据量又极大，所有直接求逆会实际计算很慢，因此一种有效的求解 likelihood function 的方法是很重要的。</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightgreen;border-left:8px solid lightgreen;border-right:8px solid lightgreen;padding:2px 5px 2px 5px;">
<em>Modern Cosmology</em> 里面举了一个具体的例子。
</p>
<h2>Karhunen-Loeve Techniques</h2>
<p>这种方法的主要想法是，丢掉那么严重被噪声污染的模。比如我们发现有用的模只有10%，那么计算逆矩阵的话，计算量就减少到了原来的1/1000。但是如何找出那些有用的模呢？</p>
<p>如果 covariance matrix 是对角的，我们之前在 【乙】 部分中提到对于对角化的 covariance matrix，我们可以得到 &#92;(C_S/C_N&#92;)，也就是信噪比。通过看信噪比的强弱，就可以知道那些模是有用的。可是真正的观测中，得到的数据的 covariance matrix 并不是对角化的，得到信噪比就比较困难。这正是 Karhunen-Loeve 方法所解决的问题。</p>
<p>现在假定我们有 &#92;(N_p&#92;) 个数据点，&#92;(&#92;Delta_i&#92;)，与之前一样，这个数据点是由信号 &#92;(s_i&#92;) 和噪声 &#92;(n_i&#92;) 组成的。为了简单，我们假定信号和噪声是不关联的。</p>
<p>使用矩阵表达式，那么 covariance martrix 就可以写成<br />
&#92;[ {&#92;bf C} &#92;equiv &#92;langle &#92;Delta &#92;Delta^{T} &#92;rangle = {&#92;bf C_S} + {&#92;bf C_N} &#92;]</p>
<p>Karhunen-Loeve technique 是利用一系列矩阵变换把 noise covariance matrix 写成单位阵，然后 signal covariance matrix 写成对角形式，这样就可以比较信号和噪声了，当然我们用的数据矩阵也应该做相应的变换。比如我们把数据矩阵转动<br />
&#92;[ {&#92;bf &#92;Delta}&#8217; = {&#92;bf R} {&#92;bf &#92;Delta} &#92;]<br />
那么相应的 covariance matrix 也就变成了<br />
&#92;[ {&#92;bf C} = &#92;langle ({&#92;bf R &#92;Delta}) ({&#92;bf R &#92;Delta}) &#92;rangle ={&#92;bf R C R^{T}} &#92;]</p>
<p>如果 &#92;({&#92;bf C}’&#92;) 是个对角化的形式，那就好办了。所以，Karhunen-Loeve technique 的操作过程应该是：</p>
<ul>
<li>通过转动矩阵 &#92;({&#92;bf R_1} &#92;) 把 &#92;({&#92;bf C_N}&#92;) 对角化为 &#92;({&#92;bf C_N}&#8221;&#92;) ；</li>
<li>通过矩阵 &#92;({&#92;bf R_2}&#92;)把 &#92;({&#92;bf C_N}&#8221;&#92;) 化为单位阵：&#92;[ {&#92;bf C_N}&#8217; = {&#92;bf R_2 R_1 C_N R_1^T R_2^T}&#92;] 其实 &#92;(&#92;bf R_2&#92;) 是个对角阵，所以 &#92;({&#92;bf R_2^T} = {&#92;bf R_2} &#92;) ；</li>
<li>通过转动矩阵 &#92;({&#92;bf R_3}&#92;) 把进行过 &#92;({&#92;bf R_1}&#92;) 和 &#92;({&#92;bf R_2}&#92;) 操作的 &#92;({&#92;bf C_S}&#92;) 对角化为 &#92;({&#92;bf C_S}&#8217;&#92;) ：&#92;[{&#92;bf C_S}&#8217; = {&#92;bf R_3 R_2 R_1 C_S R_1^T R_2 R_3}&#92;]。同时 &#92;(&#92;bf C_N&#8217;&#92;) 也必须进行 &#92;(&#92;bf R_3&#92;) 操作，但是由于实对称矩阵的对角化通过 unitary 的矩阵来实现的（&#92;({&#92;bf R_3^{-1} = {&#92;bf R_3^T}}&#92;)），所以实际上再对 &#92;(&#92;bf C_N&#8217;&#92;) 进行 &#92;(&#92;bf R_3&#92;) 操作并不改变 &#92;(&#92;bf C_N&#8217;&#92;) 是单位阵的性质，因此这一步不需要任何计算；</li>
<li>对数据点进行相应的变换 &#92;[ {&#92;bf &#92;Delta&#8217;} = ( {&#92;bf R_3 R_2 R_1 } ){&#92;bf &#92;Delta} &#92;]</li>
</ul>
<p>这样变换之后，我们最终拿到的 covariance matrix 是<br />
&#92;begin{equation}<br />
{&#92;bf C}‘ &#92;equiv &#92;langle {&#92;bf &#92;Delta&#8217;&#92;Delta&#8217;^T } &#92;rangle =  {&#92;bf C_N&#8217;} + {&#92;bf C_S&#8217;} = {&#92;bf I} + {&#92;bf C_S&#8217;}<br />
&#92;end{equation}</p>
<p>通过判断 &#92;(&#92;bf C_S&#8217;&#92;) 的元素（只有对角元）与 1 的大小，可以判断某个模式是否应该舍弃。</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightgreen;border-left:8px solid lightgreen;border-right:8px solid lightgreen;padding:2px 5px 2px 5px;">
<em>Modern Cosmology</em> P 356 有一个数据矩阵只有两个元素的例子。
</p>
<p>Karhunen-Loeve 方法已经有了很重要的应用。下图是 Bunn 和 Bond 用 K L techniques 重分析 COBE 卫星数据的几个图（<em>Modern Cosmology</em> P360）</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/12/KLTechniques.jpg" alt="" title="KL Techniques" width="550" /></p>
<p>图中左上是 signal to noise (S/N) 最大的模式，而右下是 S/N 最小的模式。实际上左上角主要是 quadrupole 的贡献，右下角的图主要是小尺度观测的贡献。</p>
<p>下图是 K L techniques 用在 galaxy survey 上面的情况（Vogeley 和 Szalay，1996）。（<em>Modern Cosmology</em> P361）</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/12/KLTechniques-GalaxySurvey.jpg" alt="" title="KLTechniques-GalaxySurvey" width="550" /></p>
<p>上图中展示的是 12 个有最大 S/N 的模式，都是大尺度的模。也就是说 K L techniques 恰好吧 galaxy survey 中的大尺度的数据筛选出来了。</p>
<p>Karhunen-Loeve technique 的另外一个很重要的用途是进行自洽性分析。<em>Modern Cosmology</em> P360 给了一个 the Python experiment 的例子。由于数据点太多，不方便直接检查数据的自洽性。于是他们使用 Karhunen-Loeve technique 把大 S/N 的数据挑出来，然后看看是不是跟观测数据所做的基本的概率假定相符，比如这里数据应该是 Gaussian 的，但是 the Python experiment 小组 第一次所用的 noise covariance matrix 导致筛选出来的这些结果并不是 Gaussian 的，于是他们就用新的 noise covariance matrix 重新做了分析。（具体例子分析请翻阅 <em>Modern Cosmology</em> P360）</p>
<p>在实际的观测中，这种方法并不是万能的，因为首先我们必须现有一个预设的 signal covariance matrix &#92;(&#92;bf C_S&#92;)，其次，这种方法在进行了上面的这么多的操作进行筛选数据点之后，还是需要按照原来的求解 likelihood 的方法来计算，也就是还是要求逆，虽然我们上面进行过了对角化，但是这只是一个特殊点进行的，也就是选择 &#92;(&#92;bf C_S&#92;) 是所定的点，这样在其他点，这些矩阵并不是对角化的，计算还是比较复杂。</p>
<h2>Optimal Quadratic Estimator</h2>
<p>上面的 K L techniques 还是要硬算 likelihood 的，而 optimal quadratic estimator 是一种不需要去完整的求解全局的 likehood 的方法。</p>
<p>Optimal quadratic estimator 是类似于 Newton 切线法求方程的根的方法，因为实际上我们要求解的量只是 likelihood 极大的时候的参数值，所以我们只需要找到如下方程的根就可以了，<br />
&#92;[ &#92;left.&#92;frac{&#92;partial &#92;scr L}{&#92;partial &#92;lambda} &#92;right| _ {&#92;lambda = &#92;bar &#92;lambda}= 0 &#92;]<br />
按照 Newton-Raphson 方法的想法，需要选定一个初始的参数空间的位置 &#92;(&#92;lambda^{(0)}&#92;)，因为对于多项式形式的函数这样的算法比较有优势，所以我们现在假定 likelihood 是 &#92;(&#92;bf C_S&#92;) 和 &#92;(&#92;bf C_N&#92;) 的 Gaussian 函数，那么我们对 likelihood 取 log 之后的式子就变成多项式形式了。这样我们把 &#92;(&#92;ln &#92;scr L&#92;) 在 &#92;(&#92;lambda^{(0)}&#92;) 附近展开</p>
<p>&#92;[<br />
(&#92;ln &#92;mathscr L) _{,&#92;lambda} (&#92;lambda) = (&#92;ln &#92;mathscr L) _{,&#92;lambda}(&#92;lambda^{(0)}) + (&#92;ln &#92;mathscr L) _{,&#92;lambda&#92;lambda}(&#92;lambda^{(0)}) ( &#92;lambda &#8211; &#92;lambda^{(0)}) &#92;]</p>
<p>只取前面的两项，并且把极值点真正的参数值 &#92;(&#92;hat &#92;lambda&#92;)带入，有 &#92;({&#92;ln&#92;scr L}_{,&#92;lambda} = 0&#92;)，即</p>
<p>&#92;[ &#92;hat&#92;lambda &#92;approx &#92;lambda^{(0)} &#8211; &#92;frac{ (&#92;ln &#92;scr L) _{,&#92;lambda}(&#92;lambda^{(0)}) }{(&#92;ln &#92;scr L) _{,&#92;lambda&#92;lambda}(&#92;lambda^{(0)})} &#92;]</p>
<p>实际上上式中所谓的 &#92;(&#92;hat &#92;lambda&#92;) 只是一个近似的准确值，因为我们只取了 Taylor 展开的前两项。但是通过迭代的方法，我们就可以无限趋近于真正的极值。</p>
<p>这种方法中出现了 likelihood 的导数。可以用 CMB 的情况作为例子来看看如何计算。对 CMB 来说<br />
&#92;[ (&#92;ln &#92;mathscr L) _{,&#92;lambda} = &#92;frac{&#92;partial}{&#92;partial &#92;lambda}&#92;left[ -&#92;frac{1}{2}&#92;ln(&#92;det C) &#8211; &#92;frac{1}{2} &#92;Delta C^{-1}&#92;Delta &#92;right]&#92;]</p>
<p>利用矩阵的一些计算技巧，&#92;(&#92;ln &#92;det(C) = &#92;mathrm{Tr} &#92;ln(C) &#92;) 和 &#92;( C_{,&#92;lambda}^{-1} = &#8211; C^{-1} C _ {,&#92;lambda} C^{-1} &#92;)<br />
&#92;begin{eqnarray}<br />
(&#92;ln &#92;mathscr L)_{,&#92;lambda} &amp;=&amp; &#92;frac{&#92;partial}{&#92;partial &#92;lambda}&#92;left[ -&#92;frac{1}{2}&#92;ln(&#92;det C) &#8211; &#92;frac{1}{2} &#92;Delta C^{-1}&#92;Delta &#92;right] &#92;nonumber &#92;&#92;<br />
&amp;=&amp; -&#92;frac{1}{2}&#92;frac{&#92;partial}{&#92;partial &#92;lambda} &#92;ln(&#92;det C) &#8211; &#92;frac{1}{2} &#92;Delta &#92;frac{&#92;partial}{&#92;partial &#92;lambda} C^{-1} &#92;Delta  &#92;nonumber &#92;&#92;<br />
&amp;=&amp; -&#92;frac{1}{2} &#92;mathrm{Tr} [C^{-1} C _ {,&#92;lambda}] + &#92;frac{1}{2}&#92;Delta C^{-1}C _ {,&#92;lambda}C^{-1} &#92;Delta<br />
&#92;end{eqnarray}</p>
<p>重复使用上述技巧，可以得出二阶导数<br />
&#92;[ (&#92;ln &#92;mathscr L) _ {,&#92;lambda&#92;lambda} = -&#92;Delta C^{-1}C _ {,&#92;lambda} C^{-1} C _ {,&#92;lambda} C^{-1}&#92;Delta + &#92;frac{1}{2} &#92;mathrm{Tr} [ C^{-1} C _ {,&#92;lambda} C^{-1} C _ {,&#92;lambda} ] +&#92;frac{1}{2} ( &#92;Delta C^{-1} C _ {,&#92;lambda&#92;lambda} C^{-1} &#92;Delta &#8211; &#92;mathrm {Tr} [ C^{-1} C _ {,&#92;lambda&#92;lambda} ] ) &#92;]</p>
<p>为了方便，定义一个 curvature，<br />
&#92;[ &#92;mathscr F = &#8211; &#92;frac{&#92;partial^2 &#92;ln &#92;mathscr L}{&#92;partial &#92;lambda^2} &#92;]</p>
<p>并且<br />
&#92;[ F _ {,&#92;lambda&#92;lambda} &#92;equiv &#92;langle &#92;mathscr F &#92;rangle = &#92;frac 1 2 &#92;mathrm{Tr} [ C _ {,&#92;lambda} C^{-1} C _ {,&#92;lambda} C^{-1} ] &#92;]</p>
<p>于是<br />
&#92;begin{equation}<br />
&#92;hat&#92;lambda = &#92;lambda^{(0)} + F^{-1} _ {&#92;lambda&#92;lambda} &#92;frac{&#92;Delta C^{-1}C _ {,&#92;lambda} C^{-1} &#92;Delta &#8211; &#92;mathrm {Tr} [ C^{-1} C _ {,&#92;lambda} ] }{ 2 }<br />
&#92;end{equation}</p>
<p>从这个 CMB 的例子可以更好的了解具体如何计算。按照我们一开始的想法，只要我们把按照这个过程多进行几次迭代就可以了。</p>
<p>但是上面所讲仅仅是一个参数的情况，那么对于多个参数的情况呢？</p>
<p>多参数的情况就变成了</p>
<p>&#92;begin{equation}<br />
&#92;hat &#92;lambda _ &#92;alpha^{(0)} + F^{-1} _ {&#92;alpha&#92;beta} &#92;frac{ &#92;Delta C^{-1} C _ {,&#92;beta} C^{-1} &#92;Delta &#8211; &#92;mathrm{Tr} [ C^{-1} C _ {,&#92;beta} ] }{ 2 }<br />
&#92;end{equation}</p>
<p>其中原来的 curvature 变成了 Fisher matrix<br />
&#92;[ F _ {&#92;alpha&#92;beta} &#92;equiv &#92;langle &#8211; &#92;frac{ &#92;partial^2 (&#92;ln &#92;mathscr L) }{ &#92;partial &#92;lambda _ {&#92;alpha} &#92;partial &#92;lambda _ {&#92;beta} } &#92;rangle = &#92;frac12&#92;mathrm{Tr}[ C _ {,&#92;alpha} C^{-1} C _ {,&#92;beta} C^{-1} ] &#92;]</p>
<p>到此为止，这种方法告诉我们其实我们不需要曲完整的求解整个参数空间中的 likelihood function，而只需要估计一个参数空间的点，然后通过迭代的方法就可以了。这样只需要求解一个局域的参数空间而已。</p>
<p>下一步就是要得到参数误差。其实我们已经假定了数据是 Gaussian 的，所以只需要按照 Gaussian 分布来给定误差就可以了。</p>
<p>因此 variance of estimator 就是<br />
&#92;[ &#92;langle (&#92;hat&#92;lambda _ &#92;alpha &#8211; &#92;bar &#92;lambda _ &#92;alpha)(&#92;hat &#92;lambda _ &#92;beta &#8211; &#92;bar &#92;lambda _ &#92;beta) &#92;rangle = (F^{-1}) _ {&#92;alpha&#92;beta} &#92;]</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightgreen;border-left:8px solid lightgreen;border-right:8px solid lightgreen;padding:2px 5px 2px 5px;">
<em>Modern Cosmology</em> P 367 中有关于为什么我们这里求解的 \(\hat\lambda\) 的期望值正好等于真正的理论值 \(\bar \lambda\) 的证明。这个证明从一方面说明了我们按照 Gaussian 分布给出结果的误差是正确的。
</p>
<p>Fisher matrix 变得非常重要，因为 Fisher matrix 不仅仅要用来计算参数空间极值，还直接决定了我们的数据拟合结果的好坏。下一篇 post 我们就来看看 Fisher matrix 的计算方法。</p>
<hr />
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightpink;padding:2px 5px 2px 5px;">
本文没有 flag。</p>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/4364" rel="bookmark" title="宇宙学中的统计方法【丙】">宇宙学中的统计方法【丙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2970" rel="bookmark" title="宇宙学中的统计方法【乙】">宇宙学中的统计方法【乙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2918" rel="bookmark" title="宇宙学中的统计方法【甲】">宇宙学中的统计方法【甲】 </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/4389/feed</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>宇宙学中的统计方法【丙】</title>
		<link>http://multiverse.lamost.org/blog/4364</link>
		<comments>http://multiverse.lamost.org/blog/4364#comments</comments>
		<pubDate>Sat, 01 Dec 2012 12:45:45 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[Statistics]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[物理]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=4364</guid>
		<description><![CDATA[宇宙学中的统计方法笔记系列，第三篇：Galaxy Survey 中的统计方法。 系列文章目录： 宇宙学中的统计方法【甲】 宇宙学中的统计方法【乙】 宇宙学中的统计方法【丙】 宇宙学中的统计方法【丁】 【乙】中讲到的是 CMB 的统计。CMB 是一个二维面上的连续的温度场，而且是我们做了简单的假设说是 Gaussian 分布的。Galaxy Survey 跟 CMB 有很大的不同，它是三维空间中的分立的星系分布，而且这里 Non-Gaussian 很重要。 Galaxy Survey 的数据 Galaxy survey 是这样进行的：先把要进行巡天的天空分成足够小的区域，每个小区域有足够多的星系用来统计。然后都每个区域进行计数，分别除以每个小区域的体积就是星系的数密度，平均数密度就是总星系个数除以总体积。 数学上，Tegmark 提出了一个 galaxy survey 中的一个像素点上的数据的定义 &#92;begin{equation} &#92;Delta_i = &#92;int&#92;mathrm d^3x &#92;psi_i(&#92;vec x) &#92;left[ &#92;frac{n(&#92;vec...<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/4389" rel="bookmark" title="宇宙学中的统计方法【丁】">宇宙学中的统计方法【丁】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2970" rel="bookmark" title="宇宙学中的统计方法【乙】">宇宙学中的统计方法【乙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2918" rel="bookmark" title="宇宙学中的统计方法【甲】">宇宙学中的统计方法【甲】 </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[<p>宇宙学中的统计方法笔记系列，第三篇：Galaxy Survey 中的统计方法。<span id="more-4364"></span></p>

<p>系列文章目录：</p>
<ul>
<li><a href="http://multiverse.lamost.org/blog/2918">宇宙学中的统计方法【甲】</a></li>
<li><a href="http://multiverse.lamost.org/blog/2970">宇宙学中的统计方法【乙】</a></li>
<li><a href="http://multiverse.lamost.org/blog/4364">宇宙学中的统计方法【丙】</a></li>
<li><a href="http://multiverse.lamost.org/blog/4389">宇宙学中的统计方法【丁】</a></li>
</ul>
<hr />
<p>【乙】中讲到的是 CMB 的统计。CMB 是一个<strong>二维</strong>面上的<strong>连续</strong>的温度场，而且是我们做了简单的假设说是 <strong>Gaussian</strong> 分布的。Galaxy Survey 跟 CMB 有很大的不同，它是<strong>三维</strong>空间中的<strong>分立</strong>的星系分布，而且这里 <strong>Non-Gaussian</strong> 很重要。</p>
<h2>Galaxy Survey 的数据</h2>
<p>Galaxy survey 是这样进行的：先把要进行巡天的天空分成足够小的区域，每个小区域有足够多的星系用来统计。然后都每个区域进行计数，分别除以每个小区域的体积就是星系的数密度，平均数密度就是总星系个数除以总体积。</p>
<p>数学上，Tegmark 提出了一个 galaxy survey 中的一个像素点上的数据的定义<br />
&#92;begin{equation}<br />
&#92;Delta_i = &#92;int&#92;mathrm d^3x &#92;psi_i(&#92;vec x) &#92;left[ &#92;frac{n(&#92;vec x) &#8211; &#92;bar n(&#92;vec x)}{&#92;bar n(&#92;vec x)} &#92;right] &#92;label{eqn-def-pixeldata}<br />
&#92;end{equation}<br />
其中 &#92;(n(&#92;vec x)&#92;) 是位置 &#92;(&#92;vec x&#92;) 处的星系数密度，&#92;(&#92;bar n(&#92;vec x)&#92;) 是平均数密度，&#92;(&#92;psi_i(&#92;vec x)&#92;) 是不同的区域的权重。<br />
对于 &#92;(&#92;psi_i(&#92;vec x)&#92;) 的选择根据情况而定，其中有两种选择，分别是实空间里的和 Fourier 空间里的，<br />
&#92;[<br />
&#92;psi_i^{&#92;text{CIC}}(&#92;vec x) = &#92;left&#92;{<br />
&#92;begin{array}{ll}<br />
&#92;bar n(&#92;vec x) &amp;&#92;mbox{if &#92;(&#92;vec x&#92;) is in the &#92;(i&#92;)th sub-volume}&#92;&#92;<br />
0      &amp;&#92;mbox{otherwise}<br />
&#92;end{array}<br />
&#92;right.<br />
&#92;]<br />
这个权重是说，在考虑某个点的数据的时候，仅仅考虑这个点上的星系分布，其他的点处的星系分布不会影响当前位置的星系数密度。<br />
而 Fourier 空间中的写法是<br />
&#92;[<br />
&#92;psi_i^{&#92;text{Fourier}}(&#92;vec x) = &#92;frac{e^{i&#92;vec k_i &#92;cdot &#92;vec x}}{V}&#92;left&#92;{<br />
&#92;begin{array}{ll}<br />
1 &amp;&#92;mbox{&#92;(&#92;vec x&#92;) inside the survey volume} &#92;&#92;<br />
0 &amp;&#92;mbox{&#92;(&#92;vec x&#92;) outside survey volume}<br />
&#92;end{array}<br />
&#92;right.<br />
&#92;]</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
扩充两种情况的物理。 flag 1
</p>
<h2>Galaxy Survey 的 likelihood</h2>
<p>因为结构形成的理论比较复杂，星系的分布也是一个高度非线性的体系。所以想要写出一个简单的 likelihood 的表达式是很难的。</p>
<p>定义 &#92;(&#92;Delta_i(&#92;vec x)&#92;) 为某个像素点的 fractional overdensity，这便是我们测量的量。物理上讲，我们可以知道 &#92;(&#92;Delta_i(x)&#92;) 的期望值应该是 0。我们可以定义出一个 covariance matrix<br />
&#92;[ &#92;langle&#92;Delta_i &#92;Delta_j^*&#92;rangle = (C_S)_{ij} + (C_N)_{ij} &#92;]</p>
<p>这很像是 CMB 数据分析的情况。</p>
<h2>Covariance Matrix</h2>
<p>Galaxy survey 与 CMB 不同的是，covariance matrix  更容易得到。</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
根据后面的章节补充 covariance matrix 的获得。补充无信号的时候 \(\langle n^2(\vec x) \rangle\) 与 \({\bar n}^2\) 并不相等。 flag 2
</p>
<h2>Window Function</h2>
<p>如果把方程 (&#92;ref{eqn-def-pixeldata}) 重新写成<br />
&#92;[ &#92;Delta_i = &#92;int&#92;mathrm d^3x &#92;psi_i(&#92;vec x) &#92;delta(&#92;vec x) &#92;]<br />
即重定义了中括号里面的部分。&#92;(&#92;delta(&#92;vec x)&#92;) 是 overdensity 。<br />
如此，covaricance matrix 变成了</p>
<p>&#92;begin{eqnarray}<br />
({&#92;bf C_S})_{ij} &amp;=&amp; &#92;langle &#92;Delta_i&#92;Delta_j &#92;rangle &#92;vert _{&#92;text{no noise}} &#92;nonumber&#92;&#92;<br />
&amp;=&amp; &#92;int &#92;mathrm d x^3&#92;mathrm dx&#8217;^3 &#92;psi_i(&#92;vec x) &#92;psi_j(&#92;vec x&#8217;) &#92;langle &#92;delta(&#92;vec x) &#92;delta(&#92;vec x&#8217;)&#92;rangle &#92;nonumber&#92;&#92;<br />
&amp;=&amp; &#92;int &#92;mathrm d x^3&#92;mathrm dx&#8217;^3 &#92;psi_i(&#92;vec x) &#92;psi_j(&#92;vec x&#8217;) &#92;xi(&#92;vec x &#8211; &#92;vec x&#8217;)&#92;nonumber<br />
&#92;end{eqnarray}</p>
<p>其中利用了</p>
<p>&#92;begin{equation}<br />
&#92;xi(&#92;vec x -&#92;vec x&#8217;) &#92;equiv &#92;langle &#92;delta(&#92;vec x)&#92;delta(&#92;vec x&#8217;) &#92;rangle  = &#92;int &#92;mathrm d^3 &#92;frac{P(k)e^{i&#92;vec k&#92;cdot (&#92;vec x &#8211; &#92;vec x&#8217;)}}{(2&#92;pi)^3} &#92;label{eqn-def-corr-power}<br />
&#92;end{equation}</p>
<p>而这里的 &#92;(x(&#92;vec x &#8211; &#92;vec x&#8217;)&#92;) 实际上是 correlation function。而 correlation function 正好用来定义 power spectrum，即方程 (&#92;ref{eqn-def-corr-power}) 第二个等号。</p>
<p>&#92;begin{eqnarray}<br />
({&#92;bf C_S})_{ij} &amp;=&amp; &#92;int &#92;mathrm d x^3&#92;mathrm dx&#8217;^3 &#92;int &#92;frac{&#92;mathrm d^3k}{2&#92;pi}&#92;frac{&#92;mathrm d^3k&#8217;}{2&#92;pi}&#92;frac{&#92;mathrm d^3k&#8221;}{2&#92;pi} &#92;tilde&#92;psi_i(&#92;vec k) &#92;tilde&#92;psi_j^*(&#92;vec k&#8217;) P(k&#8221;) e^{i[&#92;vec k+&#92;vec l&#8221;]&#92;cdot &#92;vec x &#8211; i[&#92;vec k&#8217; + &#92;vec k&#8221;]&#92;cdot &#92;vec x&#8217;} &#92;nonumber&#92;&#92;<br />
&amp;=&amp; &#92;int &#92;frac{&#92;mathrm d^3k}{(2&#92;pi)^3} P(k)&#92;tilde &#92;psi_i(&#92;vec k) &#92;tilde &#92;psi_j^*(&#92;vec k) &#92;label{eqn-covmat}<br />
&#92;end{eqnarray}</p>
<p>分解 (&#92;ref{eqn-covmat}) 式为径向积分和立体角积分</p>
<p>&#92;begin{eqnarray}<br />
({&#92;bf C_S})_{ij} &amp;=&amp; &#92;int &#92;frac{&#92;mathrm dk}{k} &#92;int &#92;frac{&#92;mathrm d&#92;Omega_k}{4&#92;pi} &#92;frac{k^3 P(k)}{2&#92;pi^2} &#92;tilde &#92;psi_i(&#92;vec k) &#92;tilde &#92;psi_j^*(&#92;vec k) &#92;nonumber<br />
&#92;end{eqnarray}</p>
<p>这样可以把立体角积分的部分就是 window function 了。</p>
<p>&#92;[ W_{ij}(k) = &#92;int &#92;frac{&#92;mathrm d&#92;Omega_k}{4&#92;pi} &#92;tilde &#92;psi_i(&#92;vec k) &#92;tilde &#92;psi_j(&#92;vec k) &#92;]</p>
<p>从这里可以看到 galaxy survey 和 CMB 的相似之处： Window function 上，都是 weighting function 的 Fourier 变换的立体角积分，也就是立体角上的平均值，而剩余的项都与方向无关。</p>
<h3>Volume-Limited Survey</h3>
<p>这个例子是我们的巡天是限制在半径为 &#92;(R&#92;) 的区域内，并且选用 Fourier pixel 形式的 pixelization，那么 weighting function 在巡天范围之内可以写成<br />
&#92;[&#92;psi_i(&#92;vec x) = &#92;frac{e^{i&#92;vec k_i &#92;cdot &#92;vec x}}{V} &#92;]</p>
<p>做 Fourier 变换，得到<br />
&#92;[&#92;tilde &#92;psi_i(&#92;vec x) = &#92;int_{&#92;vert x&#92;vert &lt;r } &#92;mathrm d^3x &#92;frac{e^{i&#92;vec k_i &#92;cdot &#92;vec x}}{V} e^{-i&#92;vec k &#92;cdot &#92;vec x} &#92;]</p>
<p>积分<br />
&#92;[ &#92;tilde &#92;psi_i(&#92;vec k) = &#92;int x^2 &#92;mathrm dx &#92;int &#92;mathrm d&#92;Omega &#92;frac{e^{i&#92;vec k_i &#92;cdot &#92;vec x-i&#92;vec k &#92;cdot &#92;vec x}}{V} = &#92;frac{4&#92;pi}{V&#92;vert &#92;vec k -&#92;vec k_i&#92;vert }  &#92;int _0^R &#92;mathrm dx x&#92;sin(&#92;vert &#92;vec k &#8211; &#92;vec k_i&#92;vert x) &#92;]</p>
<p>最后<br />
&#92;[ &#92;tilde &#92;psi_i(&#92;vec k) = &#92;frac{4&#92;pi}{V(&#92;vert &#92;vec k &#8211; &#92;vec k_i &#92;vert)^3} [ -&#92;vert &#92;vec k -&#92;vec k_i &#92;vert R &#92;cos(&#92;vert &#92;vec k -&#92;vec k_i &#92;vert R) +&#92;sin(&#92;vert &#92;vec k -&#92;vec k_i &#92;vert R) ] &#92;]</p>
<p>做代换，&#92;(y&#92;equiv &#92;vert &#92;vec k -&#92;vec k_i &#92;vert R &#92;) ，&#92;(&#92;mu = &#92;cos &#92;phi_{&#92;vec k,&#92;vec k_i}&#92;)。然后将上面的 Fourier 空间的 weighting function 模方然后取角平均，得到 window function<br />
&#92;[ W_{ii}(k) = &#92;frac{(4&#92;pi R^3)^2}{V^2} &#92;int_{-1}^1 &#92;frac{&#92;mathrm d&#92;mu}{2} &#92;int_{0}^{2&#92;pi} &#92;frac{&#92;mathrm d&#92;phi}{2&#92;pi} &#92;frac{ (&#92;sin y &#8211; y &#92;cos y)^2 }{ y^6 } &#92;&#92;<br />
=&#92;frac{8&#92;pi^2 R^6}{V^2} &#92;int_{-1}^{1} &#92;frac{&#92;mathrm d&#92;mu}{y^6}(&#92;sin y &#8211; y &#92;cos y)^2 &#92;]</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
下面这个结果我没算，直接从书上抄来的。 flag 3</p>
<p>最后利用 &#92;(y&#92;) 和 &#92;(&#92;mu&#92;) 的关系换积分元，利用 &#92;(V = 4&#92;pi R^3 /3&#92;)<br />
&#92;[ W_{ii} = &#92;frac{9}{2k k_i R^2} &#92;int_{&#92;vert k &#8211; k_i&#92;vert R}^{&#92;vert k + k_i&#92;vert R} &#92;frac{&#92;mathrm dy}{y} j_1^2(y) &#92;]</p>
<p>这里出现了 Bessel 函数。</p>
<p>这个结果告诉我们一个很自然的结论，因为 Bessel 函数的原因，window function 会在比较大的 &#92;(k_i R&#92;) 的情况下，变得很尖锐，也就是说，最后为 covariance matrix 做贡献的，只有 &#92;(k = k_i&#92;) 附近的那些模；相反，如果 &#92;(k_i R&#92;) 比较小，那么 window function 的展宽比较大，这样就是说，对于这样情况，covariance matrix 的贡献来自于大多数模。</p>
<p>下面是在这种巡天中，对其<strong>Covariance Matix 的几点讨论</strong></p>
<p>从 window function，我们可以得到 covariance matrix。</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
具体过程暂略。flag 4
</p>
<p>当 &#92;(k_i R &#92;gt 1&#92;) 时，信号 matrix 和 noise matrix 分别是</p>
<p>&#92;[(C_S)_{ii}&#92;sim &#92;frac{P(k_i)}{V}&#92;]</p>
<p>&#92;[ (C_N)_{ii}=&#92;frac{1}{&#92;bar n V} &#92;]</p>
<p>这样得到一个比较重要的比值</p>
<p>&#92;begin{equation}<br />
&#92;frac{ (C_S) } {(C_N) }&#92;vert _{ii} &#92;sim P(k_i) &#92;bar n<br />
&#92;end{equation}</p>
<p>这个结果是说，为了能够看清信号，功率谱越大越好，数密度平均值越大越好。实际上，在比较小的尺度上，这个信号噪声比已经很小了。</p>
<p>这种 window function 的几个例子可以看图：</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/12/VolumeLimitedSurveyWindowFunction.jpg" alt="" title="Volume Limited Survey Window Function" width="550"/></p>
<p>对于大范围的 pixel，也就是小的 &#92;(k_i&#92;)，几乎所有的模都会对我们的 covariance matrix 有影响，而对于小范围的，也就是大的 &#92;(k_i&#92;)，只有接近 &#92;(k_i&#92;) 的才会对 covariance matrix 有影响。</p>
<h3>Pencil-Beam Survey</h3>
<p>Pencil-Beam Survey 就是无广度但是有深度的巡天，所探测的区域在 3D 上看来，像支铅笔，故名。</p>
<p>写成数学形式，需要用到 step function &#92;(&#92;Theta()&#92;)，通过 step function 方法可以构造出在一个在 &#92;(z&#92;) 在 &#92;([-L/2,L/2]&#92;) 内的圆柱体，具体形式是</p>
<p>&#92;[ &#92;psi_i(&#92;vec x) = &#92;frac{1}{&#92;pi R^2 L} &#92;Theta (z+L/2)&#92;Theta(L/2 -z)&#92;Theta(R^2 &#8211; x^2 -y^2) &#92;]</p>
<p>对于这种情况，我们同样可以写出 weighting function 的 Fourier 变换，记 &#92;(&#92;vec q  = &#92;vec k_i &#8211; &#92;vec k&#92;)。<br />
&#92;[ &#92;tilde&#92;psi_i(&#92;vec k) = &#92;int &#92;frac{&#92;mathrm d^3x}{&#92;pi R^2 L}e^{i(&#92;vec k_i &#8211; &#92;vec k)&#92;cdot &#92;vec x} &#92;Theta (z+L/2)&#92;Theta(L/2 -z)&#92;Theta(R^2 &#8211; x^2 -y^2) &#92;]</p>
<p>这时候用柱坐标（积分元 &#92;(r&#92;mathrm dr&#92;mathrm d&#92;theta&#92;mathrm dz&#92;)）比较方便，</p>
<p>&#92;[&#92;tilde &#92;psi_i(&#92;vec k) = &#92;frac{1}{&#92;pi R^2 L} &#92;int_{-L/2}^{L/2}&#92;mathrm d z e^{iq_z z} &#92;int_{0}^{R}&#92;mathrm dr r&#92;int_0^{2&#92;pi}&#92;mathrm d&#92;theta e^{iq_r r&#92;cos&#92;theta} &#92;label{eqn-} &#92;]</p>
<p>通过写出各个分量的积分上下限，去掉了 step function。</p>
<p>利用如下的积分技巧<br />
&#92;[ &#92;int_0^&#92;infty &#92;mathrm dx x^{n-2} j_l^2(x) = 2^{n-4} &#92;pi &#92;frac{&#92;Gamma(l+n/2 &#8211; 1/2)&#92;Gamma(3-n)}{&#92;Gamma(l+5/2-n/2)&#92;Gamma^2(2-n/2)} &#92;]</p>
<p>其中 &#92;(&#92;Gamma(z) = &#92;int_0^{&#92;infty} &#92;mathrm dt t^{z-1}e^{-t}&#92;)。这样就可以把 weighting function 写成 SphericalBesselJ 函数(&#92;(j_n(z) = &#92;sqrt{&#92;pi/2} /&#92;sqrt{z} J_{n+1/2}(z) &#92;))和 Bessel 函数(&#92;(J_{n+1/2}&#92;))的形式了。</p>
<p>&#92;[ &#92;tilde &#92;psi_i(&#92;vec k) = &#92;frac{2}{R^2} j_0(q_z L/2)&#92;int_0^R &#92;mathrm dr r J_0(q_r r) &#92;]</p>
<p>利用 &#92;[ &#92;frac{&#92;mathrm d}{&#92;mathrm dx}[xJ_1(x)] = x J_0(x) &#92;] 把积分写出来</p>
<p>&#92;[ &#92;tilde &#92;psi_i(&#92;vec k) = &#92;frac{2}{(q_r R)} j_0(q_zL/2) J_1(q_rR) &#92;]</p>
<p>有了 Weighting function，就可以模仿之前的方法计算 window function 了。Window function 的行为由 Bessel related functions 来决定的。下图是从 <em>Modern Cosmology</em> 里面截取出来的一张图。图中用是当 &#92;(q_r = 0&#92;) 的特殊情况。</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/12/PencilBeamSurveyWindowFunction.jpg" alt="" title="Pencil-Beam Survey Window Function" width="550"/></p>
<p>跟之前的情况不同的是，现在对于大范围的 pixel （小&#92;(k_i R&#92;)）来说，几乎所有的模都对 covariance matix 起作用，这与上面的球形的 volume-limited survey 是一样的，但是对于小范围的 pixel （大&#92;(k_i R&#92;)）来说，&#92;(k&#92;lt k_i&#92;) 大的模都会 covariance matrix 起作用，而之前的 volume-limited survey 却是只有 &#92;(k&#92;approx k_i&#92;) 的模才会对 covariance matrix 有贡献，原因就在于 pencil-beam 是长条状的，而 window function 是要对所有三个方向的模分量来平均的。在图中所示的情况下（&#92;(q_r  = 0&#92;)），如果是要取 &#92;(q_r&#92;) 和 &#92;(q_z&#92;) 的平均然后限制其大小在 &#92;(q_{&#92;text{limit}}&#92;) 内，自然 &#92;(q_z&#92;) 会比 &#92;(q_{&#92;text{limit}}&#92;) 大多了。所以即使对于较大的 &#92;(k_i R&#92;) 会有一些比 &#92;(k &#92;lt k_i&#92;) 的模贡献进来。</p>
<hr />
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightpink;padding:2px 5px 2px 5px;">
本文共有 4 个 flag。请仔细检阅并消除所有 flag。
</p>
<p></r></p>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/4389" rel="bookmark" title="宇宙学中的统计方法【丁】">宇宙学中的统计方法【丁】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2970" rel="bookmark" title="宇宙学中的统计方法【乙】">宇宙学中的统计方法【乙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2918" rel="bookmark" title="宇宙学中的统计方法【甲】">宇宙学中的统计方法【甲】 </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/4364/feed</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>宇宙学中的统计方法【乙】</title>
		<link>http://multiverse.lamost.org/blog/2970</link>
		<comments>http://multiverse.lamost.org/blog/2970#comments</comments>
		<pubDate>Sat, 01 Dec 2012 08:24:29 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[Statistics]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[物理]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=2970</guid>
		<description><![CDATA[宇宙学中的统计方法笔记系列，第二篇：CMB 中的统计方法。 系列文章目录： 宇宙学中的统计方法【甲】 宇宙学中的统计方法【乙】 宇宙学中的统计方法【丙】 宇宙学中的统计方法【丁】 继续前面的 likelihood 的讨论，不过现在要扩展到 CMB 中来。与前面的不同的地方是，之前的例子中，我们的测量是每次一个值的，但是在 CMB 的测量中，我们的数据是一个分布，而且之前的例子的每个数据点我们是有理论可以完全预测的，而在 CMB 中，我们的分布的一个特定的数据点，我们是没有理论来完整预测的，而是只有一个对所有点的统计的预测。 CMB 的数据记录和相关理论 CMB 测量方法和数据记录待补充。flag 1 CMB 的观测中，我们把天空分成很多像素点，针对每个像素点记录温度各项异性。下面的分析中我们使用的温度各项异性，是相对于平均温度的差异。 对于各项异性的理论预言，我们选择较为简单的 Gaussian 分布的情况，即每个像素点上的温度差异分布符合 Gaussian 分布。 单像素点的 likelihood 现在我们先建立数学描述。对于天空上的一个点，我们可以测量温度各项异性，其值为 &#92;(s&#92;)，而预测值（estimator）记做 &#92;(&#92;Delta&#92;)。跟前面的例子一样，我们同样会有一个代表预测结果可靠性的量（ Modern Cosmology 中把这个叫做 variance of the estimator）的量...<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/4389" rel="bookmark" title="宇宙学中的统计方法【丁】">宇宙学中的统计方法【丁】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/4364" rel="bookmark" title="宇宙学中的统计方法【丙】">宇宙学中的统计方法【丙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2918" rel="bookmark" title="宇宙学中的统计方法【甲】">宇宙学中的统计方法【甲】 </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[<p>宇宙学中的统计方法笔记系列，第二篇：CMB 中的统计方法。<span id="more-2970"></span></p>

<p>系列文章目录：</p>
<ul>
<li><a href="http://multiverse.lamost.org/blog/2918">宇宙学中的统计方法【甲】</a></li>
<li><a href="http://multiverse.lamost.org/blog/2970">宇宙学中的统计方法【乙】</a></li>
<li><a href="http://multiverse.lamost.org/blog/4364">宇宙学中的统计方法【丙】</a></li>
<li><a href="http://multiverse.lamost.org/blog/4389">宇宙学中的统计方法【丁】</a></li>
</ul>
<hr />
<p>继续前面的 likelihood 的讨论，不过现在要扩展到 CMB 中来。与前面的不同的地方是，之前的例子中，我们的测量是每次一个值的，但是在 CMB 的测量中，我们的数据是一个分布，而且之前的例子的每个数据点我们是有理论可以完全预测的，而在 CMB 中，我们的分布的一个特定的数据点，我们是没有理论来完整预测的，而是只有一个对所有点的统计的预测。</p>
<h2>CMB 的数据记录和相关理论</h2>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
CMB 测量方法和数据记录待补充。flag 1
</p>
<p>CMB 的观测中，我们把天空分成很多像素点，针对每个像素点记录温度各项异性。下面的分析中我们使用的温度各项异性，是相对于平均温度的差异。</p>
<p>对于各项异性的理论预言，我们选择较为简单的 Gaussian 分布的情况，即每个像素点上的温度差异分布符合 Gaussian 分布。</p>
<h2>单像素点的 likelihood</h2>
<p>现在我们先建立数学描述。对于天空上的一个点，我们可以测量温度各项异性，其值为 &#92;(s&#92;)，而预测值（estimator）记做 &#92;(&#92;Delta&#92;)。跟前面的例子一样，我们同样会有一个代表预测结果可靠性的量（ <em>Modern Cosmology</em> 中把这个叫做 variance of the estimator）的量 &#92;(C_N&#92;)，类似前面的例子，对于 &#92;(s&#92;) 和 &#92;(&#92;Delta&#92;) 同样有一个分布，<br />
&#92;[ P[s] = &#92;frac{1}{&#92;sqrt{ 2&#92;pi C_N }} &#92;exp&#92;left( -&#92;frac{(&#92;Delta &#8211; s)^2}{2C_N}&#92;right) &#92;]<br />
对于理论预测，如果我们取暴涨模型所给定的 Gaussian 分布，那么就有下面的这个关于 &#92;(S&#92;) 的分布，其中参量有 &#92;(s&#92;) 和 &#92;(C_S&#92;)<br />
&#92;[ P[&#92;theta(&#92;Delta,s)] = &#92;frac{1}{&#92;sqrt{2&#92;pi C_S}}&#92;exp&#92;left( -&#92;frac{s^2}{2C_S}&#92;right) &#92;]</p>
<p>现在，我们关心的两个量是 &#92;(&#92;Delta&#92;) 和 &#92;(C_S&#92;)，因为 &#92;(&#92;Delta&#92;) 是我们要的温度各项异性值，而 &#92;(C_S&#92;) 直接跟我们后面要了解的一个量 &#92;(C_l&#92;) 关联，&#92;(C_l&#92;) 是我们要的最终结果，而 &#92;(s&#92;) 这样的量我们并不关心。所以，现在这种情况下，我们需要求的 likelihood 其实是 &#92;(P[&#92;Delta|C_S]&#92;)，也就是给定一个带有参数 &#92;(C_l&#92;) 的理论，得到数据 &#92;(&#92;Delta&#92;) 的概率。<br />
那么根据概率论（之前的例子中有具体计算步骤）<br />
&#92;[ P[&#92;Delta|C_S] = &#92;sum_s P[&#92;Delta|s] &#92;times P[s|C_S] &#92;]</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
在 <em>Modern Cosmology</em> 中，Scott Dodelson 并没有对这里的 likelihood 进行很多解释。这里 flag 一下，提醒以后注意回来检查精简这段描述。flag 2
</p>
<p>于是 Likelihood function 是概率密度的积分<br />
&#92;[ {&#92;scr L} = &#92;int^&#92;infty_{-&#92;infty} &#92;mathrm ds &#92;frac{1}{&#92;sqrt{2&#92;pi C_S}}&#92;exp&#92;left( -&#92;frac{s^2}{2C_S}&#92;right) &#92;frac{1}{&#92;sqrt{ 2&#92;pi C_N }} &#92;exp&#92;left( -&#92;frac{(&#92;Delta &#8211; s)^2}{2C_N}&#92;right) &#92;]</p>
<p>定义 &#92;(C=C_S+C_N&#92;) 是 full covariance matrix，把  &#92;(s&#92;) 积分积掉，</p>
<p>&#92;begin{eqnarray}<br />
{&#92;scr L} &amp;=&amp; &#92;int &#92;mathrm ds &#92;frac{1}{2&#92;pi &#92;sqrt{C_S C_N}} &#92;exp&#92;left( -&#92;frac{s^2 C_N + (&#92;Delta &#8211; s)^2C_S}{2C_S C_N} &#92;right) &#92;&#92;<br />
&amp;=&amp; &#92;frac{1}{2&#92;pi&#92;sqrt{C_S C_N}} &#92;int &#92;mathrm ds &#92;exp&#92;left( -&#92;frac{ C(s- C_S &#92;Delta/C)^2 + &#92;Delta^2 (C_S C_N/C) }{2C_N C_S} &#92;right) &#92;&#92;<br />
&amp;=&amp; &#92;frac{1}{&#92;sqrt{2&#92;pi C_S}}&#92;exp&#92;left( &#8211; &#92;frac{&#92;Delta^2}{2C} &#92;right) &#92;int &#92;mathrm d(s &#8211; C_S&#92;Delta/C)&#92;exp&#92;left( &#8211; &#92;frac{C(s &#8211; C_S&#92;Delta/C)^2 }{2C_S C_N} &#92;right) &#92;&#92;<br />
&amp;=&amp; &#92;frac{1}{&#92;sqrt{2&#92;pi C}}&#92;exp&#92;left( -&#92;frac{&#92;Delta^2}{2C} &#92;right)<br />
&#92;end{eqnarray}</p>
<h2>多像素点情况</h2>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
待补充。详细说明为何可以使用矩阵形式。flag 3
</p>
<p>这样我们就得到了天空中一个像素点的情况，可以推广到 N 个像素点的情况，<br />
&#92;begin{equation}<br />
{&#92;scr L} = &#92;frac{1}{(2&#92;pi)^{N/2}(&#92;mathrm {det} &#92;bf C)^{1/2}} &#92;exp&#92;left( &#8211; &#92;frac{1}{2} &#92;bf &#92;Delta &#92;bf C^{-1} &#92;bf&#92;Delta &#92;right) &#92;label{eqn-multipixellikelihood}<br />
&#92;end{equation}</p>
<p>上式（方程(&#92;ref{eqn-multipixellikelihood})）中 &#92;(&#92;Delta&#92;) 是长度为 &#92;( N &#92;)测量数据矢量，而 &#92;(C&#92;) 是 &#92;(N&#92;times N&#92;) 的 full corariance matrix。</p>
<h2>Covariance Matrix</h2>
<p>上面出现的三个 covariance matrix 分别是 &#92;(C_S&#92;)，&#92;(C_N&#92;)，&#92;(C&#92;)。其中 &#92;(C_S&#92;) 是出现在 &#92;(s&#92;) 的分布中的，也就是说是理论上 &#92;(s&#92;) 的分布宽度，称之为 signal covariance matrix，与测量中的噪声无关。从 &#92;(C_S&#92;) 到 &#92;(C&#92;) 其实是个很复杂的过程，严格的说，&#92;(C&#92;) 中需要考虑到任意的两个 parameter 直接的关联。</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
详细说明如何关联。flag 4
</p>
<h3>Covariance Matrix 的求解</h3>
<p>如果我们之考虑 covariance matrix 的对角项，<br />
&#92;[ C_{S,ii} &#92;equiv &#92;langle s_i s_i &#92;rangle &#92;]<br />
其中元素<br />
&#92;[ s_i = &#92;int &#92;mathrm d  &#92;hat n&#92;Theta(&#92;hat n) B_i(&#92;hat n) &#92;]<br />
其中 &#92;(&#92;Theta(&#92;hat n)&#92;) 是温度背景，&#92;(B_i&#92;) 是 beam pattern，也就是代表信号的性质的量。对于每个像素点都要把所有的方向的光子都考虑进来。<br />
把 &#92;(s_i&#92;) 带入 &#92;(C_{S,ii}&#92;) 可以得到 covariance matrix</p>
<p>\[ \frac{C_{S,ii}}{T^2} = \int \mathrm d\hat n \int \mathrm d\hat n&#8217; B_i(\hat n)B_i(\hat n&#8217;) \sum_{lm} Y_{lm}(\hat n)\sum_{l&#8217;m&#8217;} Y_{l&#8217;m&#8217;}^*(\hat n&#8217;)\langle a_{lm}a_{l&#8217;m&#8217;}^* \rangle \]</p>
<p>其中用到了<br />
&#92;[ &#92;Theta(&#92;hat n) = &#92;sum_{i=1}^&#92;infty &#92;sum_{m=-l}^{l} a_{lm} T Y_{lm}(&#92;hat n) &#92;]</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
*Modern Cosmology* 中写 \(\Theta\) 时不含 \(T\)，但是书中 11.35 式却含有 \(T\)，所以我把 \(T\) 添加到了 \(\Theta\) 的分解中。 flag 5
</p>
<p>把下式带入 covariance matrix 的表达式<br />
&#92;[ &#92;langle a_{lm} &#92;rangle; &#92;langle a_{lm} a_{l&#8217;m&#8217;}^* &#92;rangle = &#92;delta_{ll&#8217;}&#92;delta_{mm&#8217;}C_l &#92;]<br />
把 &#92;(l&#8217;,m&#8217;&#92;) 的求和求出来<br />
&#92;[ &#92;frac{C_{S,ii}}{T^2} = &#92;int &#92;mathrm d&#92;hat n &#92;int &#92;mathrm d&#92;hat n&#8217; B_i(&#92;hat n) B_i(&#92;hat n&#8217;) &#92;sum_{l} C_l &#92;sum_m Y_{lm}(&#92;hat n) Y_{lm}^*(&#92;hat n&#8217;) &#92;]</p>
<p>我们知道球谐函数有如下性质<br />
&#92;[ &#92;sum_m Y_{lm}(&#92;hat n)Y_{lm}^*(&#92;hat n&#8217;) = (2l+1) P_l (&#92;hat n&#92;cdot  &#92;hat n&#8217;)/4&#92;pi &#92;]<br />
定义<br />
&#92;[ W_{l,ii} = &#92;int &#92;mathrm d&#92;hat n&#92;int &#92;mathrm d&#92;hat n&#8217; B_i(&#92;hat n)B_i(&#92;hat n&#8217;) P_l(&#92;hat n&#92;cdot &#92;hat n&#8217;) &#92;]<br />
其中的 &#92;(&#92;hat n &#92;cdot &#92;hat n&#8217;&#92;) 可以写成 &#92;(&#92;cos(x)&#92;)，其中 &#92;(x&#92;) 是 &#92;(&#92;hat n&#92;) 和 &#92;(&#92;hat n&#8217;&#92;) 之间所夹的弧长。这样我们可以在一个二维平面上定义两个矢量，&#92;(&#92;vec x&#92;) 和 &#92;(&#92;vec x&#8217;&#92;)，使得  &#92;( &#92;cos(x) = &#92;cos(|&#92;vec x &#8211; &#92;vec x&#8217;|) &#92;)，即 &#92;(&#92;hat n&#92;cdot &#92;hat n&#8217; = &#92;cos(&#92;vec x &#8211; &#92;vec x&#8217;)&#92;)<br />
于是<br />
&#92;[ W_{l,ii} = &#92;int &#92;mathrm d^2x&#92;int &#92;mathrm d^2 x&#8217; B_i(x) B_i(x&#8217;) P_l(&#92;cos(|&#92;vec x &#8211; &#92;vec x&#8217;|) ) &#92;]</p>
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightblue;padding:2px 5px 2px 5px;">
为什么变成二次导数了？我求的是一次导数。回来看看。下面还是继续按照 *Modern Cosmology* 里面所讲的来写。 flag 6
</p>
<p>所以 covariance matrix 变成<br />
&#92;[ &#92;frac{C_{S,ii}}{T^2} = &#92;sum_l &#92;frac{2l+1}{4&#92;pi} C_l W_{l,ii} &#92;]</p>
<p>关于上面提到的 window function &#92;(W_{l,ii}&#92;)， 还可以继续化简。首先，我们把 Legendre polynomials 表达出来，不过这里要用一个近似，就是在 l 很大的时候， Legendre polynomials 近似变成 Bessel function.<br />
&#92;[ P_{l} (&#92;cos(|&#92;vec x &#8211; &#92;vec x&#8217;|)) &#92;rightarrow J_0 (l|&#92;vec x &#8211; &#92;vec x&#8217;|) = &#92;frac{1}{2&#92;pi} &#92;int_0^{2&#92;pi} &#92;mathrm d&#92;phi &#92;exp{-il |&#92;vec x &#8211; &#92;vec x&#8217;| &#92;cos&#92;phi} &#92;]<br />
其中 &#92;(&#92;phi&#92;) 的意思是 &#92;(l&#92;) 和 &#92;(&#92;vec x &#8211; &#92;vec x&#8217;&#92;) 之间的额夹角。&#92;(l&#92;) 的方向可以选做某条坐标轴的方向比较方便。<br />
这样我们就可以把 window function 简化成<br />
&#92;[ W_{l,ii} = &#92;frac{1}{2&#92;pi} &#92;int_0^{2&#92;pi}&#92;mathrm d&#92;phi |&#92;tilde B_i(&#92;vec l)|^2 &#92;]<br />
其中<br />
&#92;[ &#92;tilde B_i(&#92;vec l) &#92;equiv &#92;int &#92;mathrm d^2x B_i(&#92;vec x)e^{-i &#92;vec l &#92;vec x} &#92;]<br />
是 &#92;(B_i&#92;) 的 Fourier 变换。</p>
<p>这样我们就可以把 covariance matrix 的对角项表示出来了，选择特定的 window function，就可以求解。</p>
<p>但是这只是对角项，实际上非对角项也是存在的，严格的计算需要把非对角项也包括进来。</p>
<h3>Window Function 的例子</h3>
<h4>Gaussian Beam</h4>
<p>对于 Guassian beam 的情况，beam pattern 写作<br />
&#92;[ B_i(&#92;vec x) = &#92;frac{1}{2&#92;pi &#92;sigma} &#92;exp&#92;left( -&#92;frac{(&#92;vec x -&#92;vec x_i)^2}{2&#92;sigma^2} &#92;right) &#92;]<br />
先令 &#92;(&#92;vec x_i = 0&#92;)，方便 Fourier 变换。<br />
Fourier 变换得到<br />
&#92;[ &#92;tilde B_i(&#92;vec l) =&#92;frac{1}{2&#92;pi &#92;sigma^2} &#92;int &#92;mathrm d^2x e^{-i&#92;vec l &#92;cdot&#92;vec x} &#92;exp&#92;left( -&#92;frac{x^2}{2&#92;sigma^2} &#92;right) = e^{-l^2&#92;sigma^2/2} &#92;]<br />
因为 Fourier 变换之后并不涉及 &#92;(&#92;vec l&#92;) 方向，所以 window function 可以立刻得出来<br />
&#92;[ W_{l,ii} = e^{-l^2&#92;sigma^2} &#92;]</p>
<p>这个函数的行为我们都很熟悉，如下所示，</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/12/expplot.jpg" width="500" /></p>
<p>也就是说对于很大的 &#92;(l&#92;)，window function 会消失。换句话说，因为很大 &#92;(l&#92;) 正好对应很小的角分辨率，所以就是说，对于那些角分辨率小于 beam 的宽度的时候，这部分对于 covariance matrix 的贡献就自动被 window function 过滤掉了。</p>
<p>下面是一个例子。左上图是实空间里面的 beam 的 pattern，右上图表示 beam 做 Fourier 展开后在 Fourier 空间中的 pattern，下部图表示 window function。</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/12/GaussianBeam.png" alt="" title="GaussianBeam" width="550" /></p>
<h4>Differencing a Gaussian Beam</h4>
<p>Beam function 也可以选择如下形式<br />
&#92;[ B(x,y) = &#92;delta(y)[&#92;delta(x-x_0) &#8211; &#92;delta(x + x_0)] &#92;]<br />
这样的 beam function 意思是？</p>
<p>做 Fourier 变换，得到<br />
&#92;[ &#92;tilde B (&#92;vec l) = 2i&#92;sin(l_x x_0) &#92;]</p>
<p>带入 window function 得到<br />
&#92;begin{eqnarray}<br />
W_l &amp;=&amp; &#92;frac{1}{2&#92;pi} 4 &#92;int _0^{2&#92;pi} &#92;mathrm d&#92;phi &#92;sin^2(lx_0&#92;cos&#92;phi) &#92;&#92;<br />
&amp;=&amp; &#92;frac{1}{&#92;pi}&#92;int_0^{2&#92;pi} &#92;mathrm d&#92;phi (1-&#92;cos(2lx_0&#92;cos&#92;phi)) &#92;&#92;<br />
&amp;=&amp; 2(1-P_l[&#92;cos(2x_0)])<br />
&#92;end{eqnarray}<br />
这里又用了前面用过的 Bessel function 和 Legendre function 之间的近似。</p>
<p>那么如果 beam 的宽度不是无穷小，而是有限大的，那么前面的 &#92;(&#92;delta&#92;) 函数就变化成积分就好了，也就是说<br />
&#92;[ B(x,y) =  &#92;frac{ 2&#92;pi &#92;sigma^2 } &#92;int &#92;mathrm dx&#8217;&#92;mathrm dy&#8217;&#92;exp&#92;left( -&#92;frac{(x-x&#8217;)^2 + (y -y&#8217;)^2}{2&#92;sigma} &#92;right) &#92;times &#92;delta(y&#8217;) [&#92;delta(x&#8217; &#8211; x_0) &#8211; &#92;delta(x&#8217; + x_0)] &#92;]</p>
<p>那么相应的 window function 变换就是<br />
&#92;[ W_l = e^{-l^2&#92;sigma^2} (1 &#8211; P_l[&#92;cos(2x_0)]) &#92;]</p>
<p>下面是一个例子。左上图是实空间里面的 beam 的 pattern，右上图表示 beam 做 Fourier 展开后在 Fourier 空间中的 pattern，下部图表示 window function。</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/12/DifferencingGaussianBeam.png" alt="" title="Differencing Gaussian Beam" width="550" /></p>
<p>下图是一个更加紧致的 beam 的情况。</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/12/DifferencingGaussianBeam2.jpg" alt="" title="DifferencingGaussianBeam2" width="550" /></p>
<hr />
<p style="background:#f0ffff;margin:5px 15px 5px 20px;border:1px solid lightblue;border-left:8px solid lightpink;padding:2px 5px 2px 5px;">
本文共有 6 个 flag。请仔细检阅并消除所有 flag。</p>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/4389" rel="bookmark" title="宇宙学中的统计方法【丁】">宇宙学中的统计方法【丁】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/4364" rel="bookmark" title="宇宙学中的统计方法【丙】">宇宙学中的统计方法【丙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2918" rel="bookmark" title="宇宙学中的统计方法【甲】">宇宙学中的统计方法【甲】 </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/2970/feed</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>天体周围引力场和 Birkhoff 定理</title>
		<link>http://multiverse.lamost.org/blog/4090</link>
		<comments>http://multiverse.lamost.org/blog/4090#comments</comments>
		<pubDate>Sat, 06 Oct 2012 15:58:20 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[Differential Geometry]]></category>
		<category><![CDATA[General Relativity]]></category>
		<category><![CDATA[Gravity]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[物理]]></category>
		<category><![CDATA[疯狂的科学]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=4090</guid>
		<description><![CDATA[在广相中，有一个很好的定理是说，真空中的球对称引力场一定是静态的。这就是 Birkhoff 定理。Birkhoff 定理不仅可以帮助我们获得引力场分布和引力波辐射的物理图像，还可以帮助我们简化很多计算。 Birkhoff 定理 Birkhoff 定理的证明用到了如下条件: 真空。实际上可以扩展到带有 &#92;(&#92;Lambda&#92;) 的场方程。 不同的度规形式 但是这里有个地方我没有想明白，就是一个球对称的线元的普遍形式应该是:[1][2] &#92;[&#92;mathrm ds^2 = -&#92;gamma(r,t)c^2 &#92;mathrm dt^2 + &#92;alpha(r,t) [ &#92;mathrm dr^2 + r^2 ( &#92;mathrm d&#92;theta^2 + &#92;sin^2&#92;theta &#92;mathrm d&#92;phi^2 ) ] &#8211; &#92;beta(r,t)c &#92;mathrm dr&#92;mathrm dt...<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/4006" rel="bookmark" title="星系巡天">星系巡天 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/3980" rel="bookmark" title="『修改引力理论简介』简要补充">『修改引力理论简介』简要补充 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2336" rel="bookmark" title="GADGET-2安装">GADGET-2安装 </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[
<p>在广相中，有一个很好的定理是说，真空中的球对称引力场一定是静态的。这就是 Birkhoff 定理。Birkhoff 定理不仅可以帮助我们获得引力场分布和引力波辐射的物理图像，还可以帮助我们简化很多计算。</p>
<h2>Birkhoff 定理</h2>
<p>Birkhoff 定理的证明用到了如下条件:</p>
<ul>
<li>真空。实际上可以扩展到带有 &#92;(&#92;Lambda&#92;) 的场方程。<span id="more-4090"></span></li>
</ul>
<h2>不同的度规形式</h2>
<p>但是这里有个地方我没有想明白，就是一个球对称的线元的普遍形式应该是:[<sup id="fnref-4090:1"><a href="#fn-4090:1" rel="footnote">1</a></sup>][<sup id="fnref-4090:2"><a href="#fn-4090:2" rel="footnote">2</a></sup>]</p>
<p>&#92;[&#92;mathrm ds^2 = -&#92;gamma(r,t)c^2 &#92;mathrm dt^2 + &#92;alpha(r,t) [ &#92;mathrm dr^2 + r^2 ( &#92;mathrm d&#92;theta^2 + &#92;sin^2&#92;theta &#92;mathrm d&#92;phi^2 ) ] &#8211; &#92;beta(r,t)c &#92;mathrm dr&#92;mathrm dt &#92;]</p>
<p>在刘辽的书中，他做了坐标变换，然后变成了一个更加漂亮的形式：</p>
<p>&#92;[ &#92;mathrm ds^2 = -b(r,t) c^2&#92;mathrm dt^2 + a(r,t) &#92;mathrm dr^2 + r^2 (&#92;mathrm d&#92;theta^2 + &#92;sin^2&#92;theta &#92;mathrm d&#92;phi^2) &#92;]</p>
<p>新的形式（下文称为形式二，第一个度规称为形式一）是一个正交的度规，更简单更漂亮。但是有一个问题，虽然这两个度规在本质上是等价的，但是在用来求解问题的时候，却会出现不同的结果，这是因为不同的坐标限制了不同的观者族，而不同的观者对于某些观测会得到不同的结论。[<sup id="fnref-4090:3"><a href="#fn-4090:3" rel="footnote">3</a></sup>]</p>
<p>比如说，我们取上面两种形式的度规都是对角化的形式，也就是说扔掉了 &#92;(&#92;beta(r,t)&#92;)。这这样一个简单情况下，&#92;(&#92;phi&#92;) 坐标的 scale 两种形式有很大的不同，一个是包含 &#92;(r&#92;) 和 &#92;(t&#92;) 的一个函数 &#92;(&#92;alpha(r,t)&#92;)，另一种形式却没有。这一点会对后面各个几何量的求解带来很大的不同，因为涉及到了导数。</p>
<h2>计算证明</h2>
<p>基于这一点考虑，我算了一种简单的情况，就是</p>
<p>&#92;[ &#92;mathrm ds^2 = -b(r,t) c^2&#92;mathrm dt^2 + a(r,t) &#92;mathrm dr^2 + f(t) r^2 (&#92;mathrm d&#92;theta^2 + &#92;sin^2&#92;theta &#92;mathrm d&#92;phi^2) &#92;]</p>
<p>为了方便计算，对一些量进行了重定义，最后度规写为如下形式：</p>
<p>&#92;[<br />
&#92;left(<br />
&#92;begin{array}{cccc}<br />
 -e^{2 &#92;nu [r]} a[t]^2 &amp; 0 &amp; 0 &amp; 0 &#92;&#92;<br />
 0 &amp; e^{2 &#92;lambda [r]} a[t]^2 &amp; 0 &amp; 0 &#92;&#92;<br />
 0 &amp; 0 &amp; r^2 a[t]^2 &amp; 0 &#92;&#92;<br />
 0 &amp; 0 &amp; 0 &amp; r^2 a[t]^2 &#92;text{Sin}[&#92;text{theta}]^2<br />
&#92;end{array}<br />
&#92;right)<br />
&#92;]</p>
<p>放在带 &#92;(&#92;Lambda&#92;) 的场方程中，得到的结果如下：</p>
<p>需要满足一下四个方程</p>
<p>&#92;[&#92;frac{3 a'[t]^2}{a[t]^2}+&#92;frac{e^{-2 &#92;lambda [r]+2 &#92;nu [r]} &#92;left(-1+e^{2 &#92;lambda [r]}+2 r &#92;lambda &#8216;[r]&#92;right)}{r^2}==e^{2 &#92;nu [r]} &#92;Lambda  a[t]^2&#92;]</p>
<p>&#92;[ e^{2 &#92;lambda } r &#92;Lambda  a[t]^3+&#92;frac{e^{2 &#92;lambda [r]-2 &#92;nu [r]} r a'[t]^2}{a[t]}+&#92;frac{a[t] &#92;left(1-e^{2 &#92;lambda [r]}+2 r &#92;nu &#8216;[r]&#92;right)}{r}==2 e^{2 &#92;lambda [r]-2 &#92;nu [r]} r a&#8221;[t] &#92;]</p>
<p>&#92;[ r &#92;left(r &#92;Lambda  a[t]^2+&#92;frac{e^{-2 &#92;nu [r]} r a'[t]^2}{a[t]^2}-&#92;frac{2 e^{-2 &#92;nu [r]} r a&#8221;[t]}{a[t]}+e^{-2 &#92;lambda [r]} &#92;left(&#92;nu &#8216;[r]+r &#92;nu &#8216;[r]^2-&#92;lambda &#8216;[r] &#92;left(1+r &#92;nu &#8216;[r]&#92;right)+r &#92;nu &#8221;[r]&#92;right)&#92;right)==0 &#92;]</p>
<p>&#92;[ &#92;frac{1}{a[t]}e^{-2 (&#92;lambda [r]+&#92;nu [r])} r &#92;text{Sin}[&#92;text{theta}] &#92;left(e^{2 (&#92;lambda [r]+&#92;nu [r])} r &#92;Lambda  a[t]^4+e^{2 &#92;lambda [r]} r a'[t]^2-2 e^{2 &#92;lambda [r]} r a[t] a&#8221;[t]+e^{2 &#92;nu [r]} a[t]^2 &#92;left(&#92;nu &#8216;[r]+r &#92;nu &#8216;[r]^2-&#92;lambda &#8216;[r] &#92;left(1+r &#92;nu &#8216;[r]&#92;right)+r &#92;nu &#8221;[r]&#92;right)&#92;right)==0 &#92;]</p>
<p>上面的求导是针对各自自变量的求导。</p>
<p>自然其中第三和第四是在我们这里等价的。</p>
<p>经过简化，这个度规的需要满足如下要求：</p>
<p>&#92;[ &#92;frac{1}{r^2} (1-e^{2&#92;lambda}) + &#92;frac{1}{r} (&#92;nu&#8217; + &#92;lambda&#8217;) +&#92;lambda&#8217;&#92;nu&#8217; -&#92;nu&#8217;^2 &#8211; &#92;nu&#8221; =0 &#92;]<br />
外加上面的第一个方程。</p>
<p>从这样的式子里面，是无法得到 Birkhoff 定理的。因为上面的 &#92;(&#92;lambda&#92;) 和 &#92;(&#92;nu&#92;) 是 &#92;(r&#92;) 的函数，无法分离成 &#92;(r&#92;) 多项式形式，从而无法给出含时量的限制。</p>
<h2>更多</h2>
<p>其实这个理解也没有问题，因为我所使用的度规和形式二是不同的观者所使用的坐标。其他的理解在后续文章的实例中提到。我主要关心一个问题，如果我们把银河系看做浸泡在一个能动张量为 &#92;(T_{&#92;mu&#92;nu}&#92;) 的宇宙中，那么其引力场分布的解析解如何呢？</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn-4090:1">
《广义相对论》（第二版）， 刘辽、赵峥，P145。&#160;<a href="#fnref-4090:1" rev="footnote">&#8617;</a>
</li>
<li id="fn-4090:2">
我习惯于 +2 号差，所以将刘辽赵峥书中的度规做了改动。&#160;<a href="#fnref-4090:2" rev="footnote">&#8617;</a>
</li>
<li id="fn-4090:3">
一个例子，观者 A 观测到静止的电荷 E 不会辐射光子，但是一个加速运动的观者 B 却会观测到 E 辐射光子。&#160;<a href="#fnref-4090:3" rev="footnote">&#8617;</a>
</li>
</ol>
</div>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/4006" rel="bookmark" title="星系巡天">星系巡天 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/3980" rel="bookmark" title="『修改引力理论简介』简要补充">『修改引力理论简介』简要补充 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2336" rel="bookmark" title="GADGET-2安装">GADGET-2安装 </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/4090/feed</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>如何在宇宙中找到我们 &#124; Google Maps API</title>
		<link>http://multiverse.lamost.org/blog/4015</link>
		<comments>http://multiverse.lamost.org/blog/4015#comments</comments>
		<pubDate>Mon, 01 Oct 2012 14:36:18 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[星空下的梦想]]></category>
		<category><![CDATA[天文]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[物理]]></category>
		<category><![CDATA[疯狂的科学]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=4015</guid>
		<description><![CDATA[前些天接触的 google maps api，发现果然是一个很好用的东西，可以是的任何图片变成 google maps 一样查看。 但是如果完全自己切照片，那是非常复杂的，所以 CASA 开放了一个可以自动切照片的程序： GMap Image Cutter. 程序用 java 写的，使用非常简单，有可视化界面。 下面是两个例子，这两张图片给出了我们在宇宙中的位置， 点击此处查看上图的全页面版本 点击此处查看上图的全页面版本 其实我一直想把嫦娥的探月图片以这种形式展示出来，虽然嫦娥官方也有类似的展示，但是那个体验太差了，而且显得乱糟糟，无奈仔细读了官方的图片使用须知，得知不能随便在服务器上放置并在自己网站上展示嫦娥探月图片，所以就只能作罢，另外大致估算的话，对于那张经典的 1.3G 的图片，切了之后，我的账号是放不下这么大的文件的。 BTW，我所展示的第一张图片，是 wikipedia 的 public domain，但是第二章图片，是 NG 拿来卖钱的，所以实际上我是不能随便放到网站上的……<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/2358" rel="bookmark" title="iAstro及其他">iAstro及其他 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1946" rel="bookmark" title="Evolution of Background and Perturbations in {Cosmology} [Intro]">Evolution of Background and Perturbations in {Cosmology} [Intro] </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1321" rel="bookmark" title="宇宙学到底悲剧到什么程度">宇宙学到底悲剧到什么程度 </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[<p>前些天接触的 google maps api，发现果然是一个很好用的东西，可以是的任何图片变成 google maps 一样查看。</p>
<p>但是如果完全自己切照片，那是非常复杂的，所以 CASA 开放了一个可以自动切照片的程序： <a href="http://www.casa.ucl.ac.uk/richard/GoogleMapImageCutter/gmimgcut-DownloadChoices.asp">GMap Image Cutter</a>.</p>
<p>程序用 java 写的，使用非常简单，有可视化界面。<span id="more-4015"></span></p>
<p><a href="http://multiverse.lamost.org/blog/wp-content/uploads/2012/10/GMapImageCutterUI.png"><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/10/GMapImageCutterUI.png" alt="GMapImageCutterUI" title="GMapImageCutterUI" width="550px" /></a></p>
<p>下面是两个例子，这两张图片给出了我们在宇宙中的位置，</p>
<p><iframe src="http://multiverse.lamost.org/testbed/WhereAreWe/" width="570px" height="500px" frameborder="0"></iframe></p>
<p><a href="http://multiverse.lamost.org/testbed/WhereAreWe/">点击此处查看上图的全页面版本</a></p>
<p><iframe src="http://multiverse.lamost.org/testbed/NGUniverseMap/" width="570px" height="500px" frameborder="0"></iframe></p>
<p><a href="http://multiverse.lamost.org/testbed/NGUniverseMap/">点击此处查看上图的全页面版本</a></p>
<p>其实我一直想把嫦娥的探月图片以这种形式展示出来，虽然嫦娥官方也有类似的展示，但是那个体验太差了，而且显得乱糟糟，无奈仔细读了官方的图片使用须知，得知不能随便在服务器上放置并在自己网站上展示嫦娥探月图片，所以就只能作罢，另外大致估算的话，对于那张经典的 1.3G 的图片，切了之后，我的账号是放不下这么大的文件的。</p>
<hr />
<p>BTW，我所展示的第一张图片，是 wikipedia 的 public domain，但是第二章图片，是 NG 拿来卖钱的，所以实际上我是不能随便放到网站上的……</p>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/2358" rel="bookmark" title="iAstro及其他">iAstro及其他 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1946" rel="bookmark" title="Evolution of Background and Perturbations in {Cosmology} [Intro]">Evolution of Background and Perturbations in {Cosmology} [Intro] </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1321" rel="bookmark" title="宇宙学到底悲剧到什么程度">宇宙学到底悲剧到什么程度 </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/4015/feed</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>星系巡天</title>
		<link>http://multiverse.lamost.org/blog/4006</link>
		<comments>http://multiverse.lamost.org/blog/4006#comments</comments>
		<pubDate>Mon, 01 Oct 2012 12:27:53 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[Dark Energy]]></category>
		<category><![CDATA[Galaxy Survey]]></category>
		<category><![CDATA[General Relativity]]></category>
		<category><![CDATA[Gravity]]></category>
		<category><![CDATA[Modified_Gravity]]></category>
		<category><![CDATA[天文]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[物理]]></category>
		<category><![CDATA[疯狂的科学]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=4006</guid>
		<description><![CDATA[为了创建自己的引力理论测试资料库，我在 github 上创立一个 repository，来收集巡天，太阳系和地面试验的资料，并且使用 octopress 创立了一系列 html 页面，以方便查阅。 欢迎 fork! 星系巡天可以为了解大尺度结构和检查引力理论提供很重要的数据。为了方便以后查阅，现在依照以下模板来统计： Objectives: XXXXXX &#124; Completed Parameters: Facilities: Frequency/Channel: Objects: XXXX &#124; about how many XXXX measured Distance: Area: Resolution: Results Image here. What does that figure mean? Links: XXX XXX...<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/4090" rel="bookmark" title="天体周围引力场和 Birkhoff 定理">天体周围引力场和 Birkhoff 定理 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/3980" rel="bookmark" title="『修改引力理论简介』简要补充">『修改引力理论简介』简要补充 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2336" rel="bookmark" title="GADGET-2安装">GADGET-2安装 </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[<p><strong>为了创建自己的引力理论测试资料库，我<a href="https://github.com/CosmologyTaskForce/CosmologyTaskForce">在 github 上创立一个 repository，来收集巡天，太阳系和地面试验的资料</a>，并且<a href="http://cosmologytaskforce.github.com/CosmologyTaskForce/">使用 octopress 创立了一系列 html 页面</a>，以方便查阅。</strong></p>
<p><a href="https://github.com/CosmologyTaskForce/CosmologyTaskForce/tree/source">欢迎 fork!</a></p>
<hr />
<p>星系巡天可以为了解大尺度结构和检查引力理论提供很重要的数据。为了方便以后查阅，现在依照以下模板来统计：<span id="more-4006"></span></p>
<ul>
<li><strong>Objectives</strong>: XXXXXX | <strong>Completed</strong></p>
</li>
<li>
<p><strong>Parameters</strong>:</p>
<ul>
<li>Facilities: </li>
<li>Frequency/Channel:</li>
<li>Objects: XXXX | about how many XXXX measured</li>
<li>Distance: </li>
<li>Area: </li>
<li>Resolution:</li>
</ul>
</li>
</ul>
<p><strong>Results</strong></p>
<p>Image here.</p>
<p>What does that figure mean?</p>
<p><strong>Links</strong>:</p>
<ol>
<li>XXX</li>
<li>XXX</li>
</ol>
<hr />
<p>正在进行中的项目：</p>
<p><a href="http://cosmologytaskforce.github.com/CosmologyTaskForce/blog/Galaxy%20Surveys/Cosmological%20Surveys/galaxy-surveys/">http://cosmologytaskforce.github.com/CosmologyTaskForce/blog/Galaxy%20Surveys/Cosmological%20Surveys/galaxy-surveys/</a></p>
<hr />
<p>了解一下我们在宇宙中的位置：<a href="4015">如何在宇宙中找到我们</a></p>
<hr />
<p>BTW，我在使用 octopress 的时候遇到一个问题，就是每次重启机器之后，如果想要使用 rake generate，需要使用 rvm rubygems latest 一次才可以，否则会出现 syntax error。请问这是为什么？感觉好奇怪。</p>
<p>系统： Ubuntu 12.04<br />
Ruby：1.9.3<br />
使用RVM管理</p>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/4090" rel="bookmark" title="天体周围引力场和 Birkhoff 定理">天体周围引力场和 Birkhoff 定理 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/3980" rel="bookmark" title="『修改引力理论简介』简要补充">『修改引力理论简介』简要补充 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2336" rel="bookmark" title="GADGET-2安装">GADGET-2安装 </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/4006/feed</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>『修改引力理论简介』简要补充</title>
		<link>http://multiverse.lamost.org/blog/3980</link>
		<comments>http://multiverse.lamost.org/blog/3980#comments</comments>
		<pubDate>Fri, 14 Sep 2012 07:31:26 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[Dark Energy]]></category>
		<category><![CDATA[General Relativity]]></category>
		<category><![CDATA[Gravity]]></category>
		<category><![CDATA[Modified Gravity]]></category>
		<category><![CDATA[Modified_Gravity]]></category>
		<category><![CDATA[Modifying Gravity]]></category>
		<category><![CDATA[天文]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[宇宙演化]]></category>
		<category><![CDATA[物理]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=3980</guid>
		<description><![CDATA[本文是对『修改引力理论简介』一文的简单补充。 补充一：修改引力的背景补充 上个世纪曾经有一段引力理论发展的黄金时期。大约从 Einstein 的 General Relativity 开始，产生了很多的用来描述引力的理论。比较著名比如 Branks-Dicke 的理论，该理论很大限度的包括了 Mach 原理，比如突出的一点是，Brans-Dicke 理论中包含了 Mach 的惯性与环境相关的想法，也就是说在地球上做水桶实验中转动的水桶之所以会呈现出漩涡状，是因为水桶周围有其他物质，整个宇宙合起来造成了我们对惯性的测量，从而可以理解成引力也应当与周围环境有关。后来还有很多类似的理论，这样就产生了一类 Scalar-Tensor 理论。 当时产生的理论大都可以在小尺度上退化到 GR，但是由于当时还没有宇宙加速膨胀的结论，所以大家并没有什么足够强烈的动机来使用这样的理论。但是上个世纪末的超新星测距离实验所带给我们的宇宙加速膨胀的结论，给了我们一个足够的理由来怀疑 GR 在大尺度上的准确性了，毕竟，我们只是在太阳系内比较精密的验证了 GR. 如果我们怀疑 GR 的准确性，那么我们有两条路可以走，一条是创造全新的理论，另一条是在 GR 基础上改造，一般而言，第二条路是更加实惠的方案。 如果要改造 GR， 从作用量出发是比较简单直观的。Einstein 的 General Relativity 理论中，作用量可以写作 &#92;[&#92;frac{1}{16&#92;pi G}&#92;int &#92;mathrm d^4 x &#92;sqrt{-g}...<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/4006" rel="bookmark" title="星系巡天">星系巡天 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2782" rel="bookmark" title="修改引力理论[脑图]">修改引力理论[脑图] </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1946" rel="bookmark" title="Evolution of Background and Perturbations in {Cosmology} [Intro]">Evolution of Background and Perturbations in {Cosmology} [Intro] </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[<p>本文是对『修改引力理论简介』一文的简单补充。</p>
<h3>补充一：修改引力的背景补充</h3>
<p>上个世纪曾经有一段引力理论发展的黄金时期。大约从 Einstein 的 General Relativity 开始，产生了很多的用来描述引力的理论。比较著名比如 Branks-Dicke 的理论，该理论很大限度的包括了 Mach 原理，比如突出的一点是，Brans-Dicke 理论中包含了 Mach 的惯性与环境相关的想法，也就是说在地球上做水桶实验中转动的水桶之所以会呈现出漩涡状，是因为水桶周围有其他物质，整个宇宙合起来造成了我们对惯性的测量，从而可以理解成引力也应当与周围环境有关。后来还有很多类似的理论，这样就产生了一类 Scalar-Tensor 理论。<span id="more-3980"></span><br />
当时产生的理论大都可以在小尺度上退化到 GR，但是由于当时还没有宇宙加速膨胀的结论，所以大家并没有什么足够强烈的动机来使用这样的理论。但是上个世纪末的超新星测距离实验所带给我们的宇宙加速膨胀的结论，给了我们一个足够的理由来怀疑 GR 在大尺度上的准确性了，毕竟，我们只是在太阳系内比较精密的验证了 GR.</p>
<p>如果我们怀疑 GR 的准确性，那么我们有两条路可以走，一条是创造全新的理论，另一条是在 GR 基础上改造，一般而言，第二条路是更加实惠的方案。</p>
<p>如果要改造 GR， 从作用量出发是比较简单直观的。Einstein 的 General Relativity 理论中，作用量可以写作</p>
<p>&#92;[&#92;frac{1}{16&#92;pi G}&#92;int &#92;mathrm d^4 x &#92;sqrt{-g} R(g) + &#92;int &#92;mathrm d^4 x &#92;mathscr L (g, Matter)&#92;]</p>
<p>我们可以动的地方，可以用下面的这张图来说明：</p>
<p><a href="http://multiverse.lamost.org/blog/wp-content/uploads/2012/09/modifiedgravitythepage.jpg"><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/09/modifiedgravitythepage.jpg" alt="" title="Howtomodifygravity" width="600" /></a><br />
<center><a href="http://multiverse.lamost.org/blog/wp-content/uploads/2012/09/modifiedgravitythepage.jpg">点击图片看大图</a></center></p>
<h3>补充二：修改引力理论脑图补充</h3>
<p>截取 <a href="http://lss.bao.ac.cn/meeting/cosmo12/talk/0912am/COSMO12_plenary0912m_PedroFerreira.pdf">Pedro Ferreira 的报告</a>里面的一张幻灯片作为补充:</p>
<p><a href="http://multiverse.lamost.org/blog/wp-content/uploads/2012/09/COSMO12_plenary0912m_PedroFerreira_10.jpg"><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/09/COSMO12_plenary0912m_PedroFerreira_10.jpg" alt="" title="COSMO12_plenary0912m_PedroFerreira_10" width="600" /></a><br />
<center><a href="http://multiverse.lamost.org/blog/wp-content/uploads/2012/09/COSMO12_plenary0912m_PedroFerreira_10.jpg">点击图片看大图</a></center></p>
<h3>补充三：其他『没有暗能量/暗能量被掩盖』的理论</h3>
<p>这部分不算是修改引力的补充，但是暂时也没地方放，所以就附在这里。</p>
<p>有很多没有暗能量的理论，或者暗能量不是我们所观测到的这样的的理论，比如</p>
<ul>
<li><strong>Void</strong></li>
</ul>
<p>该模型认为我们生活在一个不均匀的宇宙中并且生活在一个很大的空洞中，这样很容易解释超新星的数据。有些人将这个理论发展的很好了，很多数据都可以解释。</p>
<ul>
<li><strong>重新从经典场论的角度考察 Eisntein 的 GR</strong></li>
</ul>
<p>通过经典场论的方法来重新考虑 GR 的变分过程（重新理解基本场）。通过仔细的设计，总可以使得作用量中的一些项不出现在运动方程中。例子： <a href="http://arxiv.org/abs/1203.1040">Cleaning Up the Cosmological Constant</a></p>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/4006" rel="bookmark" title="星系巡天">星系巡天 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2782" rel="bookmark" title="修改引力理论[脑图]">修改引力理论[脑图] </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1946" rel="bookmark" title="Evolution of Background and Perturbations in {Cosmology} [Intro]">Evolution of Background and Perturbations in {Cosmology} [Intro] </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/3980/feed</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>关于暗能量那些稀奇古怪的名字</title>
		<link>http://multiverse.lamost.org/blog/2985</link>
		<comments>http://multiverse.lamost.org/blog/2985#comments</comments>
		<pubDate>Wed, 18 Jul 2012 12:17:59 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[天文]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[宇宙演化]]></category>
		<category><![CDATA[物理]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=2985</guid>
		<description><![CDATA[唯象的来看，暗能量有些诡异的名字，可以列一下主要的：
* Quintessence
* Phantom
* Quintom

**Quintessence** 就是 the fifth element, 或者说是 fifth essence. 有部电影就是讲这个的([The Fifth Element](http://movie.douban.com/subject/1293531))。
**Phantom** 就不用说了，到处出现的一个词，游戏上，小说中，电影中。差不多等于 Ghost 吧，不过好像比 Ghost 更加有亲和力一点。
**Quintom** 是个自造词，没什么历史渊源，是将上面两者结合起来的。是不是可以理解成 The ghost who can use the power of the fifth essence 啊，哈哈～
<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/2327" rel="bookmark" title="工作进展（2011-12-18）">工作进展（2011-12-18） </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1959" rel="bookmark" title="Evolution of Background and Perturbations in {Cosmology} [Details]">Evolution of Background and Perturbations in {Cosmology} [Details] </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1766" rel="bookmark" title="我们的宇宙可能由闭宇宙演化为开宇宙么？[第三节]">我们的宇宙可能由闭宇宙演化为开宇宙么？[第三节] </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[<hr />
<p>唯象的来看，暗能量有些诡异的名字，可以列一下主要的[<sup id="fnref-2985:1"><a href="#fn-2985:1" rel="footnote">1</a></sup>]：</p>
<ul>
<li>Quintessence</li>
<li>Phantom</li>
<li>Quintom</li>
</ul>
<p><span id="more-2985"></span></p>
<p><strong>Quintessence</strong> 就是 the fifth element, 或者说是 fifth essence. 有部电影就是讲这个的(<a href="http://movie.douban.com/subject/1293531">The Fifth Element</a>)。<br />
<strong>Phantom</strong> 就不用说了，到处出现的一个词，游戏上，小说中，电影中。差不多等于 Ghost 吧，不过好像比 Ghost 更加有亲和力一点。<br />
<strong>Quintom</strong> 是个自造词，没什么历史渊源，是将上面两者结合起来的。是不是可以理解成 The ghost who can use the power of the fifth essence 啊，哈哈～</p>
<hr />
<h3>那，这些都是什么意思呢？</h3>
<p>这些可以从动力学的角度来看，比如可以写出作用量，然后分析对我们来说最必要的一个量：Equation of State (EoS).</p>
<p>一般而言，我们总可以把 Lagrangian 写成动能项和势能项，也就是说作用量可以一般的写成如下形式：</p>
<p>&#91;A=\int \mathrm d^4 x \sqrt{-g} (X-V)&#93;</p>
<p>其中 &#40;X&#41; 代表动能项，&#40;V&#41; 代表势能项。下面我们来分类。</p>
<ul>
<li><strong>Quintessence</strong> ：</li>
</ul>
<p>&#91;X=-\frac{1}{2} \partial_\mu \phi \partial^\mu \phi&#93;</p>
<p>这样可以用经典的变分原理来写出能动张量，然后可以分离出能量密度&#40;\rho&#41;和压强&#40;p&#41;这两个量。[<sup id="fnref-2985:2"><a href="#fn-2985:2" rel="footnote">2</a></sup>]</p>
<p>现在引入一个很重要的量，EoS，状态方程。其定义如下：</p>
<p>&#91;w=\frac{p}{\rho}&#93;</p>
<p>这是我们用的状态方程的定义。为什么要这样定义？因为这样可以反映该物质的特定的性质：压强和能量密度的关系。为什么不写成&#40;\rho/p&#41;，因为&#40;p&#41;可能为0。</p>
<p>由此，我们得到 <strong>Quintessence</strong> 的 EoS ，</p>
<p>&#91;w=\frac{\frac12 \dot\phi^2-V}{\frac12 \dot\phi^2+V}&#93;</p>
<p>如此以来，因为动能项一直是正的，势能项又是负值，所以 <strong>Quintessence</strong> 的 EoS 有一下特点</p>
<p>&#91;0>w>-1&#93;</p>
<p>很有趣，因为 <a href="/blog/2861">LCDM 模型</a>所对应的唯象的 EoS 恰好是 -1。所以说 -1 的状态方程很重要，下面可以更清楚的看到这一点。</p>
<ul>
<li><strong>Phantom</strong> ：</li>
</ul>
<p>&#91;X=\frac{1}{2} \partial_\mu \phi \partial^\mu \phi&#93;</p>
<p>同样的方法，可以得到 <strong>Phantom</strong> 的 EoS 为</p>
<p>&#91;w=\frac{\frac12 \dot\phi^2 + V}{\frac12 \dot\phi^2 &#8211; V}&#93;</p>
<p>正好是之前的倒数。因此这个应该是：</p>
<p>&#91;w&lt; -1&#93;</p>
<ul>
<li><strong>Quintom</strong> ：</li>
</ul>
<p><strong>Quintom</strong> 采取了兼容并包的方法，也就是把之前两者都包含进来了：</p>
<p>&#91;X=-\frac{1}{2} \partial_\mu \phi \partial^\mu \phi+\frac{1}{2} \partial_\mu\psi \partial^\mu \psi&#93;</p>
<p>可以得到一个更一般的状态方程</p>
<p>&#91;w=\frac{\frac12 \dot\phi^2-\frac12 \dot\psi^2-V}{\frac12 \dot\phi^2-\frac12 \dot\psi^2+V}&#93;</p>
<p>不出所料，这个状态方程应该是可以穿过 -1 的。</p>
<hr />
<h3>干嘛用的？</h3>
<p>为什么要这样分类呢？因为 &#40;w&lt;-1&#41; 和 &#40;0>w>-1&#41; 的暗能量可以带给宇宙不同的命运。可以想象一下，如果暗能量有着很大的呀强，那么同样多的暗能量，可以提供更强烈的加速，因此宇宙撕裂将会更容易出现或者更快出现。相反，我们倒是有可能生活在一个安稳的宇宙中。</p>
<p>因此分成不同的类别来考察他们对宇宙演化的影响是很自然的。</p>
<hr />
<h3>为什么要提到 EoS ？</h3>
<p>因为这家伙很直接的影响到我们的宇宙的命运。如何？</p>
<p>我们可以通过 Friedmann 方程来考察宇宙的演化，其中一个比较重要的问题是：<a href="/blog/1801">我们的宇宙会是一直膨胀下去还是会先膨胀然后坍缩</a>？<br />
把 EoS 的定义带入进来，可以通过<a href="/blog/1766">1766号文章</a>中的方法来考察背景宇宙的演化。这样就可以知道，不同类型的暗能量，对宇宙的演化的作用不同。比如，Phantom 将会带给我们 big rip，我们的世界将会毁灭，一切都将不复存在。</p>
<hr />
<p>因为我们不知道暗能量是什么，所以我们也不能准确的知道 EoS 是什么形式。原则上来说，在我们弄清楚暗能量本质之前，只能唯象的把 EoS 参数化。</p>
<p style="color:orange;">有个挺有意思的小事情：我们可以把不同方法参数化的 EoS 的相图找到，分成 <strong>Phantom</strong>, <strong>Quintessence</strong> 和 <strong>Quintom</strong> 等区域，这样更加方便的知道这种参数化的覆盖的范围。</p>
<p>比如比较经典的参数化形式 CPL 参数化[<sup id="fnref-2985:3"><a href="#fn-2985:3" rel="footnote">3</a></sup>]的。</p>
<p><img src="http://multiverse.lamost.org/blog/wp-content/uploads/2012/07/DataFitting2.jpg" alt="CPL Parameterized EoS Phase Space" title="CPL Parameterized EoS Phase Space" width="580"/></p>
<div class="footnotes">
<hr />
<ol>
<li id="fn-2985:1">
其他的比如 K-essence 之类的，此处不提。&#160;<a href="#fnref-2985:1" rev="footnote">&#8617;</a>
</li>
<li id="fn-2985:2">
如何做？我们一般定义能量密度&#40;\rho&#41;为 &#40;T^0_0=-\rho&#41;，这个号差无关。如此我们可以通过变分原理求出能动张量的表达式，然后放到这个定义中，既可得到能量密度的表达式。至于压强，因为我们用了理想流体模型，此处就直接定义 &#40;T_{ij}=g_{ij} p&#41;，同样的方法得到压强表达式。此处变分应当认为引力为基本场，因为我们考察的是一个引力体系中的引力场的性质，与一般做法过程稍有区别，结果一致。&#160;<a href="#fnref-2985:2" rev="footnote">&#8617;</a>
</li>
<li id="fn-2985:3">
CPL parameterization, or Chevallier-Polarski-Linder parameterization.&#91;w=w0 + wa \frac{z}{1+z}=w0 + wa (1-a)&#93;这里 &#40;z&#41; 为红移[<sup id="fnref-2985:4"><a href="#fn-2985:4" rel="footnote">4</a></sup>]， &#40;a=1/(1+z)&#41; 为 scale factor 。&#160;<a href="#fnref-2985:3" rev="footnote">&#8617;</a>
</li>
<li id="fn-2985:4">
Redshift, same definition as the one in Doppler effect. However it is generalized in Cosmology. Check Wikipedia for more information. &#160;<a href="#fnref-2985:4" rev="footnote">&#8617;</a>
</li>
</ol>
</div>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/2327" rel="bookmark" title="工作进展（2011-12-18）">工作进展（2011-12-18） </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1959" rel="bookmark" title="Evolution of Background and Perturbations in {Cosmology} [Details]">Evolution of Background and Perturbations in {Cosmology} [Details] </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/1766" rel="bookmark" title="我们的宇宙可能由闭宇宙演化为开宇宙么？[第三节]">我们的宇宙可能由闭宇宙演化为开宇宙么？[第三节] </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/2985/feed</wfw:commentRss>
		<slash:comments>4</slash:comments>
		</item>
		<item>
		<title>宇宙学中的统计方法【甲】</title>
		<link>http://multiverse.lamost.org/blog/2918</link>
		<comments>http://multiverse.lamost.org/blog/2918#comments</comments>
		<pubDate>Mon, 25 Jun 2012 12:16:43 +0000</pubDate>
		<dc:creator><![CDATA[时见疏星]]></dc:creator>
				<category><![CDATA[天尽头的纸条]]></category>
		<category><![CDATA[Statistics]]></category>
		<category><![CDATA[宇宙学]]></category>
		<category><![CDATA[物理]]></category>

		<guid isPermaLink="false">http://multiverse.lamost.org/blog/?p=2918</guid>
		<description><![CDATA[本文是宇宙学统计中的非常非常小的一部分。是我刚刚读了一篇文章(arXiv:0911.3105)的一部分后所学到的。如有谬误，欢迎指出。2012-11-30补充了一个 Modern Cosmology 中的实例。此为系列文章第一篇：统计基础。 系列文章目录： 宇宙学中的统计方法【甲】 宇宙学中的统计方法【乙】 宇宙学中的统计方法【丙】 宇宙学中的统计方法【丁】 约定 假定我们的宇宙遵从特定的规律，可以设想这样的两种观测者。一种是自然之上的创世者们，比如叫他们宇宙定制公司，他们非常清楚宇宙所遵从的规律，而且也知道宇宙是在什么样的参数下运行；另一种是宇宙之内卑微的生存者，比如我们地球上这些渺小的人类，我们并不知道宇宙是精确的规律是什么，也不知道在某个规律下面宇宙的参数是如何设定的，我们只能实验和观测，更加难堪的是，在宇宙学中，我们基本上只能进行观测，想要尝试去改变一些宇宙的设定来得到某些结果，目前还只能出现在科幻小说之中。 那么对于宇宙定制公司的人们来说，他知道宇宙的精确的理论是 H ，（对于我们来说是个假设而已，因为从我们的角度来看就是个 Hypothesis，简称 H ），而我们生活的宇宙可以用一个模型 &#92;(&#92;theta(&#92;theta_1,&#92;theta_2,&#8230;)&#92;) 来描述，其中 &#92;(&#92;theta_i&#92;) 为模型参数，而且他们知道宇宙运行之后的数据 D，（比较幸运的是，对于很多数据 D，我们也是可以得到的，因为我们就限定 D 为我们可以得到的数据）。 基本概念 那么从宇宙定制公司的角度来看： 可以根据 H 来计算 &#92;(&#92;theta&#92;) 模型下的某个数据出现的理论概率，比如现在在一个范围 A 内，共有 M 颗1型超新星，和 N 颗2型超新星。他们可以计算在拿到了 m 颗1型超新星和...<div class='yarpp-related-rss'>
<hr />
<big><strong><font color="#ff6600">长程相关文章:</font></strong></big><ol>
<li><a href="http://multiverse.lamost.org/blog/4389" rel="bookmark" title="宇宙学中的统计方法【丁】">宇宙学中的统计方法【丁】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/4364" rel="bookmark" title="宇宙学中的统计方法【丙】">宇宙学中的统计方法【丙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2970" rel="bookmark" title="宇宙学中的统计方法【乙】">宇宙学中的统计方法【乙】 </a><hr /></li>
</ol>
</div>
]]></description>
				<content:encoded><![CDATA[<p>本文是宇宙学统计中的非常非常小的一部分。是我刚刚读了一篇文章(arXiv:0911.3105)的一部分后所学到的。如有谬误，欢迎指出。2012-11-30补充了一个 <em>Modern Cosmology</em>  中的实例。此为系列文章第一篇：统计基础。<span id="more-2918"></span></p>

<p>系列文章目录：</p>
<ul>
<li><a href="http://multiverse.lamost.org/blog/2918">宇宙学中的统计方法【甲】</a></li>
<li><a href="http://multiverse.lamost.org/blog/2970">宇宙学中的统计方法【乙】</a></li>
<li><a href="http://multiverse.lamost.org/blog/4364">宇宙学中的统计方法【丙】</a></li>
<li><a href="http://multiverse.lamost.org/blog/4389">宇宙学中的统计方法【丁】</a></li>
</ul>
<hr />
<h2>约定</h2>
<p>假定我们的宇宙遵从特定的规律，可以设想这样的两种观测者。一种是自然之上的创世者们，比如叫他们宇宙定制公司，他们非常清楚宇宙所遵从的规律，而且也知道宇宙是在什么样的参数下运行；另一种是宇宙之内卑微的生存者，比如我们地球上这些渺小的人类，我们并不知道宇宙是精确的规律是什么，也不知道在某个规律下面宇宙的参数是如何设定的，我们只能实验和观测，更加难堪的是，在宇宙学中，我们基本上只能进行观测，想要尝试去改变一些宇宙的设定来得到某些结果，目前还只能出现在科幻小说之中。</p>
<p>那么对于宇宙定制公司的人们来说，他知道宇宙的精确的理论是 H ，（对于我们来说是个假设而已，因为从我们的角度来看就是个 Hypothesis，简称 H ），而我们生活的宇宙可以用一个模型 &#92;(&#92;theta(&#92;theta_1,&#92;theta_2,&#8230;)&#92;) 来描述，其中 &#92;(&#92;theta_i&#92;) 为模型参数，而且他们知道宇宙运行之后的数据 D，（比较幸运的是，对于很多数据 D，我们也是可以得到的，因为我们就限定 D 为我们可以得到的数据）。</p>
<h2>基本概念</h2>
<p><strong>那么从宇宙定制公司的角度来看：</strong></p>
<p>可以根据 H 来计算 &#92;(&#92;theta&#92;) 模型下的某个数据出现的理论概率，比如现在在一个范围 A 内，共有 M 颗1型超新星，和 N 颗2型超新星。他们可以计算在拿到了 m 颗1型超新星和 n 颗2型超新星之后，随便抽取一颗是1型的概率，因为整个宇宙在任何时空点的配置他们都清楚的很。这种我们统统称之为计算 &#92;(P(D|&#92;theta(&#92;theta_1,&#92;theta_2,..))&#92;)，即 likelihood. 意思是说，我们现在知道一个模型&#92;(&#92;theta&#92;)和参数&#92;(&#92;theta_1,&#92;theta_2,&#8230;&#92;)，得到某个结果 D 的概率是多少。</p>
<p>这差不多是宇宙定制公司用的最多的计算了吧。</p>
<p>而<strong>对于我们来说</strong>，情况变得就复杂多了。我们只有观测数据，并不知道宇宙的理论 H 和具体的模型及参数 &#92;(&#92;theta(&#92;theta_1,&#92;theta_2,&#8230;)&#92;)。而我们希望通过这些观测了解到宇宙背后的理论和具体模型及参数。<br />
因此<strong>从我们的角度来看</strong>却只能计算 Posterior，记作 &#92;(P(&#92;theta|D)&#92;)，意思是说，我们有一堆观测数据 D ，那么一个特定的模型&#92;(&#92;theta&#92;)并且取某些特定的参数 &#92;(&#92;theta(&#92;theta_1,&#92;theta_2,&#8230;)&#92;)的概率是多少。</p>
<p>可以看到这样一种记法，| 是符合条件符合，可以直接读作&#8221;符合条件&#8221;，因为这个条件概率的条件放在后面。而 &#92;(P(x | y)&#92;) 的意思就是，给定 &#92;(y&#92;) 发生 &#92;(x&#92;) 的概率。</p>
<p>为了更明白，我重复 arXiv:0911.3105 中的一个例子。</p>
<blockquote><p>
  If you have an urn with N red balls and M blue balls and you draw one ball at the time then probability theory can tell you what are your chances of picking a red ball given that you have already drawn n red and m blue: P(D|H). However this is not what you want to do: you want to make a few drawn from the urn and use probability theory to tell you what is the red vs blue distribution inside the urn: P(H|D). In the Frequentist approach all you can compute is P(D|H).
</p></blockquote>
<p>这里 &#92;(P(D|H)&#92;) 是 likelihood， 而 &#92;(P(H|D)&#92;) 是 posterior. 可以明显的看到，likelihood 是指我们明了系统的详细配置的情况下计算某件事情发生的概率，这个很强大;而 posterior 是我们不知道系统的配置的情况下，可以根据很多的实验来计算出的一个概率。这个例子中提到，如果我们可以做无穷次实验，那么就可以计算 posterior，即使我们是生活在2012年的地球人。==~</p>
<h2>Likelihood 的例子</h2>
<p>从 <em>Modern Cosmology</em> 中（337页）取一个例子，稍加修改。算是一段插曲。</p>
<p>我们要测量自己的体重，作为科学工作者，大家肯定都知道要多次测量，去平均值，还要给出误差。那么平均值该如何求的呢？误差又该如何求的呢？</p>
<p>我们现在可以假定一个理论，说每次测量的体重有两部分组成，一个是体重的精确值 &#92;(theta_0&#92;)，另一个是噪音（noise）。如果我们假定测量是个 Gaussian distribution，<br />
&#92;[ P[D|&#92;theta(&#92;theta_0,&#92;sigma)] &#92;equiv &#92;scr L(D,&#92;theta(&#92;theta_0,&#92;sigma)) = &#92;frac {1}{ &#92;sqrt{2&#92;pi&#92;sigma^2}} exp&#92;left({-&#92;frac{(&#92;theta &#8211; &#92;theta_0)^2}{2&#92;sigma^2}}&#92;right) &#92;]<br />
那么精确值 &#92;(&#92;theta_0&#92;) 是分布的极值点，而每次测量的噪音的大小可以用分布中的 &#92;(&#92;sigma&#92;) 来表征。这样我们这个理论中有两个参数：&#92;(&#92;theta_0&#92;)， &#92;(&#92;sigma&#92;)。</p>
<p>上面的 &#92;(P[D|&#92;theta(&#92;theta_0,&#92;sigma)]&#92;) 是指的一次测量中，给定一个理论 &#92;(&#92;theta(&#92;theta_0,&#92;sigma)&#92;)，我们测得一个数据 &#92;(D&#92;) 的概率。但是实际上我们可能进行 N 次独立测量，这样的话，likelihood 应该是<br />
&#92;[ &#92;scr L(D,&#92;theta(&#92;theta_0,&#92;sigma)) = &#92;frac {1}{ (2&#92;pi&#92;sigma^2)^{N/2}} exp&#92;left({-&#92;frac{&#92;sum^{N}_{i=1}(&#92;theta_i &#8211; &#92;theta_0)^2}{2&#92;sigma^2}}&#92;right) &#92;]</p>
<p>但是，我们做实验的人并不想要上面所求的 &#92;( P[D|&#92;theta(&#92;theta_0,&#92;sigma)]&#92;)，相反，我们要的是 &#92;(P[&#92;theta(&#92;theta_0,&#92;sigma)|D]&#92;)。</p>
<p>概率论中，我们有<br />
&#92;[ P[A&#92;cap B] = P[A|B]P[B] = P[B|A]P[A] &#92;]<br />
这样我们就可以得到 likelihood 跟我们要求的量之间的关系。<br />
&#92;[ P[&#92;theta(&#92;theta_0,&#92;sigma)|D] = &#92;frac{ P[D|&#92;theta(&#92;theta_0,&#92;sigma)P[&#92;theta(&#92;theta_0,&#92;sigma)]] }{ P[D] } &#92;]</p>
<p>式中分母 &#92;(P[D]&#92;) 并不会影响我们的概率极值在 &#92;(&#92;theta_0 ~ &#92;sigma&#92;) 相空间的位置，所以我们暂时把这一项丢掉，剩下的分子上的 prior，即 &#92;(P[&#92;theta(&#92;theta_0,&#92;sigma)]&#92;) 项，我们可以假设是均匀分布的。这样我们就可以简化到下式，<br />
&#92;[ P[&#92;theta(&#92;theta_0,&#92;sigma)] &#92;sim &#92;scr L &#92;]</p>
<p>这样我们就把要求解的量 &#92;(P[&#92;theta(&#92;theta_0,&#92;sigma)]&#92;) 与 likelihood 联系起来了，而 likelihood 我们是可以写出表达式的。</p>
<p>那么下面我们就是要找到参数空间的最佳拟合点，也就是参数空间中概率最大的地方。分别对两个参数求导，&#92;(&#92;frac{&#92;partial &#92;scr L}{&#92;partial {&#92;theta_0}}&#92;)，&#92;(&#92;frac{&#92;partial &#92;scr L}{&#92;partial &#92;sigma}&#92;)。</p>
<p>高斯分布的情况下，情况就简单了。<br />
&#92;[ &#92;frac{&#92;partial &#92;scr L}{&#92;partial {&#92;theta_0}} = &#92;frac{&#92;sum^N_{i=1} (&#92;theta_i &#8211; &#92;theta_0) }{ &#92;sigma^2 (2&#92;pi&#92;sigma^2)^{N/2} }  &#92;exp &#92;left( -&#92;frac{&#92;sum^N_{i=1} (&#92;theta_i &#8211; &#92;theta_0)}{2&#92;sigma^2} &#92;right)&#92;]<br />
令上式为零，得到<br />
&#92;[ &#92;sum^N_{i=1}(&#92;theta_i &#8211; &#92;theta_0) = 0 &#92;]<br />
也就是说，&#92;(&#92;theta_0&#92;) 是 &#92;(&#92;theta_i&#92;) 的平均值，记做 &#92;(&#92;bar&#92;theta&#92;)。</p>
<p>这段的意思是说，如果我们做了一堆实验，那么实验的理论值（按照我们一开始提出的理论）应该是所有值的代数平均 &#92;(&#92;bar&#92;theta&#92;)。</p>
<p>对于另外一个参数 &#92;(&#92;sigma&#92;)，</p>
<p>&#92;[ &#92;frac{&#92;partial &#92;scr L}{&#92;partial &#92;sigma} = &#92;scr L &#92;left( -&#92;frac{N}{2&#92;sigma^2} + &#92;frac{&#92;sum^N_{i=1} (&#92;theta_i &#8211; &#92;theta_0)^2 }{2&#92;sigma^4} &#92;right) &#92;]</p>
<p>上式为零，得到<br />
&#92;[ &#92;sigma^2 = &#92;frac{&#92;sum^N_{i=1} (&#92;theta_i &#8211; &#92;theta_0) }{ N } &#92;]<br />
也就是说， &#92;(&#92;sigma^2&#92;) 是测量数据统计的方差。</p>
<p>这只是找到了参数空间的最佳拟合，这样的两个数据有时候并不够用，我们需要进一步写出更加方便的表达测量误差的方法，一个比较好的方法是看分布的半高宽，但是我们的表达式里面半高宽并不容易看出来，于是我们可以把e指数里面的求和式写开来，<br />
&#92;[ &#92;exp&#92;left( &#8211; &#92;frac{(&#92;theta_N &#8211; &#92;frac 1 2 &#92;theta_0)}{&#92;sigma^{2/N}} &#8211; &#92;cdots &#92;right) = &#92;exp&#92;left( &#8211; &#92;frac{(&#92;theta_N &#8211; &#92;theta_0)}{(2&#92;sigma)^{2/N}}&#92;right) &#92;cdots &#92;exp&#92;left( &#8211; &#92;frac{(&#92;theta_1 &#8211; &#92;theta_0)}{(2&#92;sigma)^{2/N}}&#92;right) &#92;]</p>
<p>这样我们可以把每个因子的e指数里面的二次项系数合起来，&#92;(N/&#92;sigma^2&#92;)，可以认为整个e指数的宽度是 &#92;( &#92;frac{&#92;sigma}{N^{1/2}} &#92;)。当然这只是一个大致的说法，详细的定义可以看概率论的书（？）或者看 <em>Modern Cosmology</em> P339。<br />
这个结果很合理，分布的越散，测量的可信度就越小，测量次数越多，测量的可信度就越大。</p>
<p>到此我们把理论值和误差都表达出来了，也就是说，我们的整个 likehood 的可以由两个两个参数，分别是 estimator &#92;(&#92;bar&#92;theta&#92;) 和 variance of estimator &#92;(&#92;frac{&#92;sigma}{N^{1/2}}&#92;)，来确定。那么，现在我们就可以放弃之前带有复杂求和式的表达形式，而重新定为一个更加简单的形式：<br />
&#92;[ &#92;scr L = &#92;frac{1}{&#92;sqrt {2&#92;pi C_N}} &#92;exp&#92;left( -&#92;frac{(&#92;theta &#8211; &#92;bar&#92;theta)}{2C_N} &#92;right) &#92;]<br />
其中用到 &#92;(&#92;sigma^2 = &#92;frac{&#92;sum^N_{i=1} (&#92;theta_i &#8211; &#92;bar&#92;theta)}{N}&#92;)。而 &#92;(C_N = &#92;frac{&#92;sigma^2}{N}&#92;)。</p>
<h2>&#92;(&#92;chi^2&#92;) fit / Chisquare fit</h2>
<p>现在宇宙学积累了很多的数据，而且现在的很多数据也都是很精确的。同时我们有很多的理论模型，各式各样的，很科幻的都有。那么我们如何把数据和理论结合起来呢？这就需要用到拟合，fit.</p>
<p>一个常用的技巧是 least square 拟合。这里我们用到的是 chisquare 拟合。</p>
<p>列出我们现在所拥有的:</p>
<ul>
<li>观测数据。这里我们使用1a超新星的例子。我们有这样一堆数据：超新星名字，超新星红移 &#92;(zo<br />
&#92;)，超新星亮度/distance modulus &#92;(do&#92;)，超新星的distance modulus error &#92;(e&#92;).</p>
</li>
<li>
<p>理论模型。这里使用最简单的 LCDM 作为例子。理论上可以计算红移对应的距离 &#92;(dt(z,H0,&#92;Omega m0,&#92;Omega d0,&#92;Omega k0) = c&#92;cdot (1+z)&#92;int &#92;frac{1}{H0&#92;sqrt{&#92;Omega m0 (1+zz)^3 + &#92;Omega d0 + &#92;Omega k0(1+zz)^2}}&#92;mathrm d zz&#92;)<br />
实际上 &#92;(dt&#92;) 并没有那么多独立参量。比如我们可以这样建立各个参量之间的关系：<br />
&#92;begin{eqnarray}<br />
&#92;Omega m0 + &#92;Omega d0 +&#92;Omega k0 &amp;=&amp; 1 &#92;&#92;<br />
&#92;end{eqnarray}<br />
如果是一个平坦的宇宙，那么我们还可以把 &#92;(&#92;Omega k0&#92;) 设成 0 . 为了适应不同的情况，我们就抽象的写成 &#92;(dt(z,x1,x2,&#8230;)&#92;). &#92;(z&#92;)是变量。</p>
</li>
</ul>
<p>那么我们可以定义这样一个量</p>
<p>&#92;begin{equation}<br />
&#92;chi^2(x1,x2) = &#92;sum_{l} &#92;frac{(do[i] &#8211; dt(z[i],x1,x2,&#8230;))^2}{&#92;sigma_i^2}<br />
&#92;end{equation}</p>
<p>其中 &#92;(&#92;sigma_i&#92;) 是第 i 个数据点的测量误差。</p>
<p>一旦这样定义，我们可以看到，如果我们的理论和数据完全符合，那么 &#92;(&#92;chi^2(x1,x2,&#8230;)=0&#92;). 但是，如果这样，很有可能发生了不正常的事情，实际观测和实验不太可能做到这样。但是很明显，如果 &#92;(&#92;chi^2&#92;) 太小，那么也不太正常，因为这很可能意味着对观测值的误差估计太大了等等。</p>
<p>那么多大的时候才比较好呢？如果观测有 n 个数据点，模型有 m 个参数，定义一个量 N = m &#8211; n. 当 &#92;(&#92;chi^2/N &#92;sim 1&#92;) 时，是比较正常的，因为这正好意味着数据点的 error bar 差不多都与理论曲线相交。</p>
<p>这样我们可以去遍历所有的数据点或者 steep 方法或者 MCMC 方法得到 &#92;(&#92;chi^2&#92;) 的最小值 &#92;(&#92;chi^2_{min}&#92;)，此时对于的参数为 &#92;(x1_m,x2_m,&#8230;&#92;). 这组参数就是我们这个模型在这组数据点下面的 best fit.</p>
<p>然后我们可以去绘制置信度的 contour . 即绘制在 &#92;(&#92;chi^2_{min}&#92;)，周围差别 &#92;(&#92;Delta&#92;chi^2&#92;) 的地方的曲线。对于不同的 N 值的 best fit 和不同的置信度，有不同的 &#92;(&#92;Delta&#92;chi^2&#92;) 值。</p>
<p>这些详细的技巧比如 covariance matrix 等等会在后续的 post 中出现。现在不再赘述。</p>
<hr />
<p><strong>我有一个<a href="http://cosmologytaskforce.github.com/CoChiSquare/">关于 Chisquare fit 的 git 项目</a>。这个所用到的理论基本上是中学生就可以理解的。<del>但是到2012年6月25日为止我依然感觉结果有些问题，虽然方法是正确的。</del><del></del></strong></p>
<hr />
<p>另外，如果你喜欢在豆瓣九点等这种地方读这篇文章，可以安装 math anywhere 插件，这样公式就可以显示了：<br />
https://chrome.google.com/webstore/detail/gebhifiddmaaeecbaiemfpejghjdjmhc</p>
<div class='yarpp-related-rss'>
<hr /><p><big><strong><font color="#ff6600">长程相关文章:</font></strong></big></p><ol>
<li><a href="http://multiverse.lamost.org/blog/4389" rel="bookmark" title="宇宙学中的统计方法【丁】">宇宙学中的统计方法【丁】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/4364" rel="bookmark" title="宇宙学中的统计方法【丙】">宇宙学中的统计方法【丙】 </a><hr /></li>
<li><a href="http://multiverse.lamost.org/blog/2970" rel="bookmark" title="宇宙学中的统计方法【乙】">宇宙学中的统计方法【乙】 </a><hr /></li>
</ol></p>
</div>
]]></content:encoded>
			<wfw:commentRss>http://multiverse.lamost.org/blog/2918/feed</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
	</channel>
</rss>
